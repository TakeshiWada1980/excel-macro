<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <meta name="robots" content="noindex,nofollow,noarchive" />
    <meta name="referrer" content="no-referrer" />

    <script>
      MathJax = {
        chtml: {
          displayAlign: "left",
          displayIndent: "1em",
        },
      };
    </script>

    

    <link rel="icon" href="favicon.ico" sizes="any" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c"
    />
    <link rel="stylesheet" href="style.css" />

    <title>生成AI×Excel ～身近なExcel業務から始めるAI活用～</title>
  </head>

  <body>
    <div class="openbtn"><span></span><span></span><span></span></div>
    <nav id="g-nav">
      <div id="g-nav-list">
        <!-- ---------------------------------------- -->
         <ul>
<li><a href="#第15回-技術実践セミナー" id="toc-第15回-技術実践セミナー"><span
class="toc-section-number">1</span> 第15回 技術実践セミナー</a>
<ul>
<li><a href="#注意事項" id="toc-注意事項"><span class="toc-section-number">1.1</span>
注意事項</a></li>
<li><a href="#概要" id="toc-概要"><span class="toc-section-number">1.2</span> 概要</a></li>
</ul></li>
<li><a href="#生成aiの利用準備" id="toc-生成aiの利用準備"><span class="toc-section-number">2</span>
生成AIの利用準備</a>
<ul>
<li><a href="#プロンプトを入力する際の注意点" id="toc-プロンプトを入力する際の注意点"><span
class="toc-section-number">2.1</span> プロンプトを入力する際の注意点</a></li>
</ul></li>
<li><a href="#エクセルのマクロとは" id="toc-エクセルのマクロとは"><span
class="toc-section-number">3</span> エクセルの「マクロ」とは</a>
<ul>
<li><a href="#マクロを作成する方法" id="toc-マクロを作成する方法"><span
class="toc-section-number">3.1</span> マクロを作成する方法</a></li>
<li><a href="#準備-①-エクセルのリボン設定" id="toc-準備-①-エクセルのリボン設定"><span
class="toc-section-number">3.2</span> 準備 ① (エクセルのリボン設定)</a></li>
<li><a href="#準備-②-vbaエディタの設定" id="toc-準備-②-vbaエディタの設定"><span
class="toc-section-number">3.3</span> 準備 ② (VBAエディタの設定)</a></li>
</ul></li>
<li><a href="#アドインファイルの新規作成と登録" id="toc-アドインファイルの新規作成と登録"><span
class="toc-section-number">4</span> アドインファイルの新規作成と登録</a></li>
<li><a href="#生成aiを利用してマクロを生成" id="toc-生成aiを利用してマクロを生成"><span
class="toc-section-number">5</span> 生成AIを利用してマクロを生成</a>
<ul>
<li><a href="#マクロ-vbaプログラム-の作成依頼プロンプト例-①"
id="toc-マクロ-vbaプログラム-の作成依頼プロンプト例-①"><span class="toc-section-number">5.1</span>
マクロ (VBAプログラム) の作成依頼プロンプト例 ①</a></li>
<li><a href="#マクロ-vbaプログラム-の作成依頼プロンプト例-②"
id="toc-マクロ-vbaプログラム-の作成依頼プロンプト例-②"><span class="toc-section-number">5.2</span>
マクロ (VBAプログラム) の作成依頼プロンプト例 ②</a></li>
<li><a href="#アドインにマクロを追加する" id="toc-アドインにマクロを追加する"><span
class="toc-section-number">5.3</span> アドインにマクロを追加する</a></li>
<li><a href="#追加したマクロの動作チェック" id="toc-追加したマクロの動作チェック"><span
class="toc-section-number">5.4</span> 追加したマクロの動作チェック</a></li>
<li><a href="#追加したマクロをリボンに登録" id="toc-追加したマクロをリボンに登録"><span
class="toc-section-number">5.5</span> 追加したマクロをリボンに登録</a></li>
<li><a href="#さらにマクロを追加" id="toc-さらにマクロを追加"><span
class="toc-section-number">5.6</span> さらにマクロを追加</a></li>
</ul></li>
<li><a href="#演習個別質問対応" id="toc-演習個別質問対応"><span class="toc-section-number">6</span>
演習＆個別質問対応</a>
<ul>
<li><a href="#プロンプト記述のポイント" id="toc-プロンプト記述のポイント"><span
class="toc-section-number">6.1</span> プロンプト記述のポイント💡</a></li>
</ul></li>
<li><a href="#ネクストステップ" id="toc-ネクストステップ"><span class="toc-section-number">7</span>
ネクストステップ</a></li>
<li><a href="#補足" id="toc-補足"><span class="toc-section-number">8</span> 補足</a>
<ul>
<li><a href="#マクロを利用するときの注意点" id="toc-マクロを利用するときの注意点"><span
class="toc-section-number">8.1</span> マクロを利用するときの注意点</a></li>
<li><a href="#マクロ有効ブックのオープン" id="toc-マクロ有効ブックのオープン"><span
class="toc-section-number">8.2</span> マクロ有効ブックのオープン</a></li>
</ul></li>
<li><a href="#おまけ-notebooklm-で音声概要を生成する方法"
id="toc-おまけ-notebooklm-で音声概要を生成する方法"><span class="toc-section-number">9</span>
おまけ: NotebookLM で音声概要を生成する方法</a>
<ul>
<li><a href="#手順1-3" id="toc-手順1-3"><span class="toc-section-number">9.1</span> 手順1</a></li>
<li><a href="#手順2-3" id="toc-手順2-3"><span class="toc-section-number">9.2</span> 手順2</a></li>
<li><a href="#手順3-3" id="toc-手順3-3"><span class="toc-section-number">9.3</span> 手順3</a></li>
<li><a href="#手順4-1" id="toc-手順4-1"><span class="toc-section-number">9.4</span> 手順4</a></li>
<li><a href="#手順5" id="toc-手順5"><span class="toc-section-number">9.5</span> 手順5</a></li>
</ul></li>
</ul> 
        <!-- ---------------------------------------- -->
      </div>
    </nav>

    <header class="markdown-body">
      <p>公大高専 産学連携推進会 第15回 技術実践セミナ－</p>
      <p>2025年6月12日(木) 15:00-16:30</p>
    </header>

    <main class="markdown-body">
      <!-- ---------------------------------------- -->
      <h1 data-number="1" id="第15回-技術実践セミナー"><span class="header-section-number">1</span>
      第15回 技術実践セミナー</h1>
      <ul>
      <li><strong>日時</strong> : 2025年06月12日（木）15:00～16:30</li>
      <li><strong>場所</strong> : 公大高専 地域連携テクノセンター 2階 CAD室</li>
      <li><strong>講師</strong> : 知能情報コース 教授  和田 健 (Takeshi Wada)</li>
      <li><strong>テーマ</strong> : <strong>生成AI × Excel
      ～身近なExcel業務から始めるAI活用～</strong>
      <ul>
      <li><strong>対象者</strong> : 生成AIを活用してExcel業務の改善 (マクロ作成) に興味のある方</li>
      </ul></li>
      </ul>
      <blockquote>
      <p>近年では、生成AIを活用することで、複雑なVBAコードを自ら書かずとも、自然な日本語で指示するだけでエクセルマクロを作成できるようになってきました。これにより、プログラミングの知識がない方でも、日々の業務を自動化・効率化するマクロを簡単に作成できる時代が到来しています。本セミナーでは、生成AIを前提とした実践形式の演習を通じて、データシート整形などの定型作業に対して、どのようにマクロを活用して解決していけるかを学びます。</p>
      </blockquote>
      <h2 data-number="1.1" id="注意事項"><span class="header-section-number">1.1</span>
      注意事項</h2>
      <ul>
      <li>PC などの機器保護のため、飲食は廊下においてお願いします。
      <ul>
      <li><strong>机上には「水筒」や「ペットボトル」を置かない</strong>ようにご協力をお願いします。</li>
      </ul></li>
      <li>卓上の「電源コンセント」はご自由にお使いください。</li>
      <li>休憩時間は設けませんので、適宜、水分補給や御手洗をご利用ください。</li>
      <li>このウェブページのURL ( https://takeshiwada1980.github.io/excel-macro/ )
      については、セミナー終了後、<strong>社内で共有いただいて問題ございません</strong>。研修等にも自由に活用ください。</li>
      </ul>
      <figure>
      <img src="figs/qr.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="1.2" id="概要"><span class="header-section-number">1.2</span> 概要</h2>
      <p>このセミナーの内容についての概要音声です。</p>
      <audio controls>
      <source src="summary.mp3" type="audio/mpeg">
      </audio>
      <p>このようなラジオ風の音声概要は、Googleの<a
      href="https://notebooklm.google.com/">NotebookLM</a>というAIサービスを利用して簡単に生成することができます。Googleアカウント
      (通常の無料アカウント) があれば、<strong>1日3回まで音声概要を生成すること</strong>ができます
      (2025.06.11 時点)。本資料の最後に<a
      href="#おまけ-notebooklm-で音声概要を生成する方法">簡単な利用手順</a>を掲載しています。</p>
      <h1 data-number="2" id="生成aiの利用準備"><span class="header-section-number">2</span>
      生成AIの利用準備</h1>
      <p>普段からご利用の生成AIサービスがあれば、事前にウェブブラウザからログインしておいてください。なお、以下の生成AIについては「アカウント登録なし」で利用することができます。</p>
      <ul>
      <li>ChatGPT <a href="https://openai.com/ja-JP/">https://openai.com/ja-JP/</a></li>
      <li>Gemini <a href="https://gemini.google.com">https://gemini.google.com</a></li>
      </ul>
      <h2 data-number="2.1" id="プロンプトを入力する際の注意点"><span
      class="header-section-number">2.1</span> プロンプトを入力する際の注意点</h2>
      <p>このセミナーでは「生成AI」を利用しますが、生成AIに対して与える指示文のことを「プロンプト」と言います。</p>
      <p>プロンプトを与える際に、入力ボックスのなかで「<strong>改行したいとき</strong>」は
      <code>[Shift]+[Enter]</code> を使ってください。通常の <code>[Enter]</code>
      入力ではプロンプトの「<strong>送信</strong>」になってしまいます。</p>
      <figure>
      <img src="figs/gai-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <div class="note type-tips">
      <p><strong>[Enter] で改行したいときは</strong></p>
      <p>ChatGPT や Gemini、Claude などの生成AIサイトのなかで…</p>
      <ul>
      <li><code>[Enter]</code> で「<strong>改行</strong>」</li>
      <li><code>[Ctrl]+[Enter]</code> で「<strong>プロンプト送信</strong>」</li>
      </ul>
      <p>…のようにデフォルト動作を切り替えたいときは、以下の<strong>拡張機能</strong> (Chrome対応)
      が便利です。</p>
      <p><i class="fa-solid fa-puzzle-piece"></i> <a
      href="https://chromewebstore.google.com/detail/chatgpt-ctrl+enter-sender/gbncgdhklmnckojlibfhdadpfbcdbnch">ChatGPT
      Ctrl+Enter Sender</a></p>
      <blockquote>
      <p>ChatGPTなどのAIチャットサービスでのメッセージ送信を「Ctrl+Enter」に割り当て、誤送信を防ぎます。Enterキーで改行できるため直感的に操作可能です。</p>
      <p>ChatGPT Ctrl+Enter
      Senderは、ChatGPTなどのサイトでメッセージを「Ctrl+Enter」で送信できるようにします。
      本来送信に使用されていたEnterキーで改行できるようになるため、誤ってEnterキーを押してメッセージを送信することがなくなります。</p>
      </blockquote>
      <p>なお、このセミナー会場の PC では、セキュティポリシーの都合上、Chrome
      の拡張機能をインストールすることは「できません」。</p>
      </div>
      <h1 data-number="3" id="エクセルのマクロとは"><span class="header-section-number">3</span>
      エクセルの「マクロ」とは</h1>
      <p>エクセルにおける「<strong>マクロ
      (Macro)</strong>」とは、各種作業を自動化・効率化するために用意されている標準機能のひとつになります。マクロを利用することで、次のような定型処理が「<strong>ワンクリック</strong>」で実行できるようになります。</p>
      <ul>
      <li>すべてのシートについて、カーソル位置をA1に設定して表示倍率を100%にする</li>
      <li>すべてのシートについて、印刷範囲と改ページ位置を一括設定する</li>
      <li>選択しているグラフのサイズを横5cm、縦3cmに設定し、0.75ptの黒枠線を設定する</li>
      <li>選択しているセルに対して、任意の表示形式 (例：<span
      class="masked">小数点桁数を1に固定</span>) と条件付き書式 (例：<span
      class="masked">負の数は赤色表示</span>) を同時設定する</li>
      </ul>
      <p>繰り返しの多い定型作業については、多少面倒であってもマクロを作成しておくことで、長期的には「効率アップ」「ミス軽減」「ストレス軽減」につながります。是非、積極的に利用してみてください。</p>
      <figure>
      <img src="figs/image-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>なお、マクロとは「<strong>一連の操作や手続きを自動化する仕組み</strong>」を指すコンピュータ用語で、エクセルに限らず、「ワード」や「パワーポイント」などのマイクロソフトオフィス製品でも同様に設定・利用ができます。</p>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>エクセル以外にも、ワードやパワーポイントでも「マクロ」が利用できると聞いたのですが本当ですか？総務関連の業務を想定したとき、どのようなことをワードでマクロ化すると便利そうですか？</p>
      </blockquote>
      <h2 data-number="3.1" id="マクロを作成する方法"><span class="header-section-number">3.1</span>
      マクロを作成する方法</h2>
      <p>マクロの実体は、「<strong>VBA (＝Visual Basic for
      Applications)</strong>」というプログラミング言語で書かれたプログラムとなっています。</p>
      <p>エクセルでは、次のいずれかの方法でマクロを作成することができます。</p>
      <p><strong>【方法1】</strong>
      エクセルから「<strong>VBAエディタ</strong>」を起動して、VBAのプログラムを自分で打ち込む</p>
      <p><strong>【方法2】</strong> エクセルの「<strong>マクロの記録</strong> (下図参照)
      」という機能で作業や操作を記録して、それをVBAプログラムに自動変換する</p>
      <figure>
      <img src="figs/excel-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p><strong>【方法2】</strong> は、初心者でも簡単に使える反面、<span
      class="masked">実行条件が少し変わるだけで意図どおりに動かなく</span>
      なったり、<strong>余計な操作まで記録されてしまったりする</strong>など、汎用性や柔軟性に問題があり、利用できる場面が限られてします。</p>
      <p>また<strong>【方法1】</strong>については、「<strong>(基礎的な)
      プログラミングの知識やスキル</strong>」が必要であるため、多くの人々 (＝プログラミング未経験者)
      には敷居が高いものでした。</p>
      <p>しかし、最近では ChatGPT
      などの「<strong>生成AI</strong>」を利用することで、エクセルの基礎知識
      (＝「セル」や「シート」といった用語の知識) があれば、<strong>【方法1】</strong>
      で実用マクロが作成できるようになってきました。</p>
      <p>今回のセミナーでは、マクロの本体である「VBAプログラム」の作成は
      <strong>全て生成AIに任せる</strong> という前提で、<span
      class="masked">生成AIが出力したVBAプログラムをマクロとして設定する方法</span> や、
      <strong>リボンにボタンを配置して、そこからマクロを呼び出す方法</strong>
      などを中心にハンズオン形式 (＝実際の操作を体験する形式) で学んでいきます。</p>
      <p>あわせて、トラブルの少ないマクロを安定して生成するためのプロンプトの書き方（雛形付き）についても紹介していきます。</p>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>VBAとマクロの違いって何ですか？いまいち分かりません。</p>
      </blockquote>
      <blockquote>
      <p>エクセルの「マクロの記録」を使って作成したマクロは、「実行条件が少し変わるだけで意図どおりに動かなくなったり、余計な操作まで記録されてしまったりする」と聞いたいのですが、どういうことですか？</p>
      </blockquote>
      <h2 data-number="3.2" id="準備-①-エクセルのリボン設定"><span
      class="header-section-number">3.2</span> 準備 ① (エクセルのリボン設定)</h2>
      <p>初回のみ必要な設定です。</p>
      <p>次に示すように、エクセルの「<strong>開発</strong>」タブから「<strong>コード</strong>」のカテゴリグループにアクセスできるようにしていきます。「開発」タブは、VBAプログラムの書き込みに使用する「<strong>VBAエディタ</strong>」の起動などに使用します。</p>
      <figure>
      <img src="figs/excel-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>デフォルト状態 (標準状態・初期状態) のエクセルでは
      <strong>「開発」タブが非表示になっていることが多い</strong>
      ので、まずは、これが表示されるように設定変更していきます。</p>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>「エクセルの開発タブのなかから…」と指示されたのですが、「ホーム」や「挿入」はありますが「開発」なんてありません。</p>
      </blockquote>
      <h3 data-number="3.2.1" id="手順1"><span class="header-section-number">3.2.1</span> 手順1</h3>
      <p>エクセルを起動し、(必要に応じて「空白のブック」を選択したあとに)
      メニューバーの「<strong>ファイル</strong>」から「<strong>オプション</strong>」を選択してください。</p>
      <figure>
      <img src="figs/excel-09.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>エクセルウィンドウを最大化していない場合は「<strong>オプション</strong>」の項目が隠れているので、「<strong>ファイル</strong>」から「<strong>その他…</strong>」を選択して「<strong>オプション</strong>」を選択してください。</p>
      <figure>
      <img src="figs/excel-12.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="3.2.2" id="手順2"><span class="header-section-number">3.2.2</span> 手順2</h3>
      <p>「<strong>Excelのオプション</strong>」というダイアログが表示されるので、左パネルから「<strong>リボンのユーザ設定</strong>」を選択して、以下のように「<strong>開発</strong>」という項目にチェックを入れてください。</p>
      <figure>
      <img src="figs/excel-03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="3.2.3" id="手順3"><span class="header-section-number">3.2.3</span> 手順3</h3>
      <p>ダイアログを閉じて、画面上部のタブに「<strong>開発</strong>」が表示されていることを確認してください。この設定により、次回のエクセル起動時にも「<strong>開発</strong>」タブが自動的に表示されるようになります。</p>
      <h2 data-number="3.3" id="準備-②-vbaエディタの設定"><span
      class="header-section-number">3.3</span> 準備 ② (VBAエディタの設定)</h2>
      <p>生成AIで生成したVBAプログラムを貼り付けるための「<strong>VBAエディタ</strong>」の基本設定をしてきます。これも
      <strong>初回のみ必要な設定</strong> となります。</p>
      <p>「<strong>開発</strong>」タブから「<strong>Visual
      Basic</strong>」のアイコンをクリックしてください。</p>
      <figure>
      <img src="figs/excel-04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「<strong>Visual
      Basic</strong>」のアイコンをクリックすると、以下のようなVBAプログラムを貼り付けたり、マクロの動作テストをするためのウィンドウが起動します。</p>
      <figure>
      <img src="figs/excel-05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以降、このウィンドウを「<strong>VBAエディタ</strong>」と呼びます。VBAエディタは
      <code>[Alt]+[F11]</code> のショートカットキーからも呼び出すこともできます。</p>
      <p>以下、「VBAエディタ」を使いやすいように設定変更していきます。</p>
      <h3 data-number="3.3.1" id="手順1-1"><span class="header-section-number">3.3.1</span>
      手順1</h3>
      <p>VBAエディタのメニューバーから「<strong>ツール</strong>」、「<strong>オプション</strong>」を選択してください。</p>
      <figure>
      <img src="figs/excel-10.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="3.3.2" id="手順2-1"><span class="header-section-number">3.3.2</span>
      手順2</h3>
      <p>「<strong>オプション</strong>」ダイアログの「<strong>編集</strong>」タブのなかの設定を次のように変更して、「<strong>OK</strong>」を押下してください。</p>
      <figure>
      <img src="figs/excel-06.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="3.3.3" id="手順3-1"><span class="header-section-number">3.3.3</span>
      手順3</h3>
      <p>VBAエディタの <strong>画面レイアウト</strong>
      を次のように「<strong>プロジェクトエクスプローラ</strong>」と「<strong>イミディエイトウィンドウ</strong>」だけが表示されるように設定していきます。</p>
      <figure>
      <img src="figs/excel-07.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>デフォルト状態のVBAエディタに表示されている余計なウィンドウ群は、<i class="fa-solid fa-rectangle-xmark"></i>
      ボタンで閉じてください。デフォルトでは「<strong>プロパティウィンドウ</strong>」が表示されていると思うので、これを閉じます。</p>
      <p>また、不足しているウィンドウ (表示されていないウィンドウ)
      があれば、メニューの「<strong>表示</strong>」から対象を選んで表示してください。デフォルト状態では「<strong>イミディエイトウィンドウ</strong>」が非表示になっている可能性があります。</p>
      <figure>
      <img src="figs/excel-08.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以上の設定が完了したらVBAエディタを閉じて、<strong>エクセル本体も、一旦、完全終了してください</strong>。</p>
      <h1 data-number="4" id="アドインファイルの新規作成と登録"><span
      class="header-section-number">4</span> アドインファイルの新規作成と登録</h1>
      <p>エクセルのマクロは、個別のエクセルファイル (ブック) に記述することも、エクセル本体
      (より正確には<strong>アドイン</strong>) に記述することもできます。</p>
      <p><strong>【個別のエクセルファイルに記述したマクロ】</strong>は、基本的にそのファイルのなかでしか使用できません（またファイルは「<strong>マクロ有効ブック</strong>」として保存する必要があります）。</p>
      <p>一方、<strong>【アドインとして登録したマクロ】</strong>は、どのファイルからでも呼びだすことができて、マクロを含まない通常のファイル形式のまま作業を行なうことができます。</p>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>個々のエクセルブック (ファイル) に記述するマクロと、アドイン (ファイル)
      に記述するマクロって何が違うのですか？</p>
      </blockquote>
      <blockquote>
      <p>エクセルのアドインって何ですか？「これからアドインにマクロを書いていく方法を解説します」って言われたのですが…</p>
      </blockquote>
      <div class="note type-caution">
      <p><strong>マクロ有効ブックとは</strong></p>
      <p>マクロを含むエクセルファイルは、必ず <strong>マクロ有効ブック</strong>
      (<code>*.xlsm</code>) として保存する必要があります。
      マクロを含んだままでは、普通のエクセル形式 (<code>*.xlsx</code>)
      で保存することはできません。</p>
      <p>また、マクロ有効ブックは、セキュリティ上の理由から、開くときに警告が表示されたり、メール添付すると「迷惑メール」として判定されてしまうことがあります。</p>
      <figure>
      <img src="figs/excel-11.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      </div>
      <p>このセミナーでは「<strong>すべてのシートのカーソル位置をA1にそろえる</strong>」や「<strong>選択セルに条件付き書式を素早く適用する</strong>」といった、様々な場面で共通する定型作業のマクロを扱うため、<span
      class="masked">エクセル本体 (アドイン)</span>
      にマクロを記述する方法について解説していきます。</p>
      <p>アドインとは「<strong>よく使うマクロをエクセルに「常備」しておくための仕組み</strong>」です。以下、<strong>アドイン専用ファイル</strong>
      (<code>*.xlam</code>)
      にマクロを記述して、エクセルの起動時にそれらが自動で読み込まれるように設定していきます。</p>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>エクセルのアドインファイルって、起動時に自動で読み込まれるのですか？保存場所などは決まっていますか？</p>
      </blockquote>
      <p>以下の手順も、基本的に初回のみ必要な操作になります。</p>
      <h3 data-number="4.0.1" id="手順1-2"><span class="header-section-number">4.0.1</span>
      手順1</h3>
      <p>全てのエクセル (ファイルやウィンドウ)
      が「<strong>閉じられていること</strong>」を確認してください。</p>
      <p>スタートボタンからエクセルを起動してください
      (何らかのファイルをダブルクリックして起動するのではなく、スタートボタンやタスクバーからエクセルを起動してください)。</p>
      <h3 data-number="4.0.2" id="手順2-2"><span class="header-section-number">4.0.2</span>
      手順2</h3>
      <p>エクセルが起動したら、以下のように「<strong>新規</strong>」から「<strong>空白ブック</strong>」を選択してください。なお、「起動時に自動で空白のブックが新規作成される設定」になっている場合は、この操作は不要です
      (次の手順に進んでください)。</p>
      <figure>
      <img src="figs/excel-addin-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「<strong>Book1</strong>」という新規ファイルが作成されます。なお、状況によってはファイル名が「Book2」や「Book3」になる場合もありますが問題ありません。</p>
      <figure>
      <img src="figs/excel-addin-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="4.0.3" id="手順3-2"><span class="header-section-number">4.0.3</span>
      手順3</h3>
      <p>「<strong>開発</strong>」タブから「<strong>Visual
      Basic</strong>」のアイコンをクリックして「<strong>VBAエディタ</strong>」を起動してください。あるいは
      <code>[Alt]+[F11]</code>
      のショートカットで「<strong>VBAエディタ</strong>」を起動してください。</p>
      <figure>
      <img src="figs/excel-04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>VBAエディタにおいて、以下のように「<strong>プロジェクト</strong>」ウィンドウのなかの「<strong>VBAProject
      (Book1)</strong>」を <strong>右クリック</strong>
      して、「<strong>挿入</strong>」-「<strong>標準モジュール</strong>」を選択してください。</p>
      <figure>
      <img src="figs/excel-addin-03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以下のように「標準モジュール」のなかに「<strong>Module1</strong>」という領域
      (＝VBAプログラムを記述する箇所) が作成されます。また「Book1
      Module1」という「<strong>コードウィンドウ</strong>」が開きます。コードウィンドウには
      <code>Option Explicit</code> と記述されています (あとで、これにつづけて VBA
      プログラムを貼り付けます)。</p>
      <figure>
      <img src="figs/excel-addin-04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>上図のようにウィンドウが最大化されていないとき、「コード」ウィンドウの上部を
      <strong>ダブルクリック</strong>
      するとウィンドウが最大化されます。以下、最大化した状態で作業をしてください。</p>
      <figure>
      <img src="figs/excel-addin-05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="4.0.4" id="手順4"><span class="header-section-number">4.0.4</span> 手順4</h3>
      <p>コードウィンドウのなかの <code>Option Explicit</code>
      以降の行に、<strong>生成AIで作成したVBAプログラム</strong> を追記していきます。</p>
      <p>まずは、練習のために以下の「VBAプログラム」を貼り付けてみてください。</p>
      <div class="sourceCode" id="cb1" data-caption="セルA1に乱数を書き込む処理"><pre
      class="sourceCode numberSource vb numberLines"><code class="sourceCode monobasic"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">Public</span> <span class="kw">Sub </span>A1に乱数を書き込む処理()</span>
<span id="cb1-2"><a href="#cb1-2"></a>    </span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="co">&#39; アクティブシートのA1セルに乱数（0～10）を書き込み</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>    ActiveSheet.Range(<span class="st">&quot;A1&quot;</span>).Value = Int(Rnd * 11)</span>
<span id="cb1-5"><a href="#cb1-5"></a>    </span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">End Sub</span></span></code></pre></div>
      <p>この際、<code>Option Explicit</code> を <strong>上書きしないように</strong>
      (消さないように) 貼り付けてください。以下のようになればOKです。</p>
      <figure>
      <img src="figs/excel-addin-06.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="4.0.5" id="手順5アドインファイルとして保存"><span
      class="header-section-number">4.0.5</span> 手順5：アドインファイルとして保存</h3>
      <p>これを <strong>アドインファイル</strong>
      として保存していきます。アドインは、原則として以下のパス (位置)
      に保存します。<code>xxxx</code>
      の部分は、皆さんのユーザ名に置き換えてください。セミナー会場のPCを利用している場合は
      <code>gs01</code> や <code>gs05</code> がユーザ名になります。</p>
      <pre><code>C:\Users\xxxx\AppData\Roaming\Microsoft\AddIns</code></pre>
      <p>上記の位置に <strong>アドインファイル</strong> (<code>*.xlam</code>)
      を配置することで、エクセル起動時に自動で読み込まれるようになります。</p>
      <p>まずは、VBAエディタの「<strong>保存ボタン</strong>」を押下してください。</p>
      <figure>
      <img src="figs/excel-addin-20.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のように「<strong>名前を付けて保存</strong>」のダイアログが表示されるので、まずは「ファイルの種類」を「<strong>Excel
      アドイン(<code>*.xlam</code>)</strong>」に変更してください
      (ドロップダウンリストの下部のほうにあります)。</p>
      <p>ファイルの種類を変更すると「保存先」が自動で
      <code>C:\Users\xxxx\AppData\Roaming\Microsoft\AddIns</code> になるので、確認してください。</p>
      <figure>
      <img src="figs/excel-addin-07.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>ファイル名を <span class="masked">マイアドイン.xlam</span>
      のように書き換えてから、ダイアログの右下の「保存」を押下してください。</p>
      <p>以上でアドインとしての設定は完了です。つづいて、これらの設定が正しくできているかを確認していきます。</p>
      <h3 data-number="4.0.6" id="手順6アドインファイルの自動読込みの確認"><span
      class="header-section-number">4.0.6</span> 手順6：アドインファイルの自動読込みの確認</h3>
      <p>一旦、エクセルを完全終了してください。</p>
      <p>つづいて、エクセルを起動して「<strong>新規</strong>」から「<strong>空白のブック</strong>」を選択してください。さらに「<strong>ファイル</strong>」から「<strong>オプション</strong>」を選択してください。</p>
      <figure>
      <img src="figs/excel-09.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「Excelのオプション」というダイアログが表示されるので、左パネルから「<strong>アドイン</strong>」を選択
      (❶)
      して、「<strong>アクティブではないアプリケーション</strong>」のなかに先ほど保存した「<strong>マイアドイン</strong>」が含まれていることを確認
      (❷) してください。</p>
      <figure>
      <img src="figs/excel-addin-08.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>この「マイアドイン」をアクティブに変更 (有効化) するために、「設定」のボタンを押下 (❸)
      してください。</p>
      <h3 data-number="4.0.7" id="手順7アドインの有効化"><span
      class="header-section-number">4.0.7</span> 手順7：アドインの有効化</h3>
      <p>「<strong>マイアドイン</strong>」にチェックを入れて「<strong>OK</strong>」を押下してください。</p>
      <figure>
      <img src="figs/excel-addin-09.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="4.0.8" id="手順8アドインマクロをリボンに登録"><span
      class="header-section-number">4.0.8</span> 手順8：アドインマクロをリボンに登録</h3>
      <p>マイアドインのなかの「<strong>A1に乱数を書き込む処理</strong>」というマクロを、以下のようにエクセルのリボンから「ワンクリック」で呼び出せるように設定していきます。</p>
      <figure>
      <img src="figs/excel-addin-21.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「ホーム」タブの右隣に、「<strong>マクロ</strong>」というタブを新規作成して、そこにマクロ実行のアイコンを配置していきます。「Excelのオプション」ダイアログから、「<strong>リボンのユーザ設定</strong>」を選択(➊)してください。</p>
      <p>つづいて、次のように「<strong>ホーム</strong>」を選択(❷)します
      (ホームのチェックボックスを反転させないように注意してください)。そして「<strong>新しいタブ</strong>」のボタンを押下(❸)してください。</p>
      <figure>
      <img src="figs/excel-addin-10.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のように「ホーム」の下に「<strong>新しいタブ(ユーザー設定)</strong>」が追加される(➊)ので、「<strong>名前の変更</strong>」のボタン押下して…</p>
      <ul>
      <li>「<strong>新しいタブ(ユーザー設定)</strong>」を「<strong>マクロ(ユーザー設定)</strong>」に名前変更してください。</li>
      <li>「<strong>新しいグループ(ユーザー設定)</strong>」を「<strong>練習(ユーザー設定)</strong>」に名前変更してください。</li>
      </ul>
      <p>いずれも、自動で <code>(ユーザー設定)</code> という文字列が付加されます。</p>
      <figure>
      <img src="figs/excel-addin-11.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のような状態になっていればOKです。</p>
      <figure>
      <img src="figs/excel-addin-12.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="4.0.9" id="手順9"><span class="header-section-number">4.0.9</span> 手順9</h3>
      <p>先の手順で追加したリボンのなかに、マクロの呼び出しボタンを設定していきます。</p>
      <p>まずは「<strong>練習(ユーザー設定)</strong>」を選択(➊)して、コマンド選択のドロップダウンリストを「<strong>マクロ</strong>」に切り替えます(❷)。</p>
      <p>このようにすると、先ほど有効化したアンドイン (マイアドイン.xlam)
      に記述されているマクロ一覧が表示されるので、「<strong>A1に乱数を書き込む処理</strong>」を選んで(❸)、「<strong>追加(A)&gt;&gt;</strong>」ボタンを押下(❹)します。</p>
      <figure>
      <img src="figs/excel-addin-13.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のような状態になっていればOKです。なお、必要に応じて「A1に乱数を書き込む処理」の名前を変更することもできます
      (タブやグループンの名前変更と同じです)。</p>
      <figure>
      <img src="figs/excel-addin-14.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>ダイアログ右下の「OK」ボタンを押下して、「Excelのオプション」ダイアログを終了してください。</p>
      <h3 data-number="4.0.10" id="手順10動作確認"><span class="header-section-number">4.0.10</span>
      手順10：動作確認</h3>
      <p>以上で、設定は完了です。マクロのタブから「<strong>A1に乱数を書き込む処理</strong>」をクリックしてみてください。</p>
      <figure>
      <img src="figs/excel-addin-15.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <ul>
      <li>エクセルを完全に閉じて、<strong>再度起動したときも、同様にマクロが呼び出せること</strong>
      を確認してください。</li>
      <li><strong>任意のエクセルファイルを開いて、そのファイル (ブック・シート)
      を対象にマクロが機能すること</strong> を確認してください。</li>
      </ul>
      <h1 data-number="5" id="生成aiを利用してマクロを生成"><span
      class="header-section-number">5</span> 生成AIを利用してマクロを生成</h1>
      <p>ここからは、<strong>生成AIを用いてマクロを記述し</strong>、それを作成済みの<strong>「アドイン」に追加登録していく手順</strong>について詳しく解説していきます。</p>
      <figure>
      <img src="figs/image-03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="5.1" id="マクロ-vbaプログラム-の作成依頼プロンプト例-①"><span
      class="header-section-number">5.1</span> マクロ (VBAプログラム) の作成依頼プロンプト例 ①</h2>
      <p>たとえば「<strong>すべてのシートのカーソル位置をA1に移動する処理</strong>」のマクロを実装したいとき、生成AIには次のようなプロンプトを与えます。</p>
      <p>(プロンプト例)</p>
      <blockquote>
      <p>エクセルにおいて、すべてのシートのカーソル位置をA1にするような VBAプログラム (マクロ)
      を書いてください。</p>
      </blockquote>
      <p>ここで「<strong>エクセル</strong>」や「<strong>VBAプログラム
      (あるいはマクロ)</strong>」といったキーワードは、プロンプトのなかに必ず含めるようにしてください。また「シート」や「A1
      (セル参照)」のような <span class="masked">エクセル固有の用語を正しく使って指示すること</span>
      が重要なポイントとなります。</p>
      <p>実際に上記のプロンプトを送信すれば、VBA プログラム (コード)
      を生成してくれるはずです。ただし、<strong>このような簡素なプロンプトでは、</strong> <span
      class="masked">生成されるコードの内容にばらつき</span>
      がでやすかったり、<strong>アドインとして組み込むには不適切なコード</strong>
      (＝実行時エラーが発生したり、意図した動作をしなかったりするコード) が生成される可能性が
      (相対的に) 高くなります。</p>
      <figure>
      <img src="figs/gai-03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>これは、生成AIが <span class="masked">何を前提としてコードを書くべきか</span>
      を明確に理解せぬまま
      (＝与えられないまま)、<strong>推測に基づいてコードを生成してしまうこと</strong>によるものです。一般的に「マクロ」と言うと、エクセルブック
      (<code>.xlsm</code> など)
      に記述するケースが多いため、生成AIもそれを前提にコードを生成することが考えられます。</p>
      <p>しかし、そのようなコードは、アドインファイルに組み込んだとき、(状況によっては)
      正しく動作しないことがあります。</p>
      <h2 data-number="5.2" id="マクロ-vbaプログラム-の作成依頼プロンプト例-②"><span
      class="header-section-number">5.2</span> マクロ (VBAプログラム) の作成依頼プロンプト例 ②</h2>
      <p>以上のようなケースにおいても、ある程度の知識やスキルがあればコードを修正して使うことはできます。しかし、ここでは
      <span class="masked">プログラミングの経験がない利用者</span>
      を前提にしています。そのため、生成AIには「<strong>あらかじめ十分な実行条件を含んだプロンプト</strong>
      を与えること」が重要となります。</p>
      <p>具体的には、次のようなプロンプトが推奨されます。</p>
      <div class="sourceCode" id="cb3"
      data-caption="プロンプト雛形（エクセルアドインマクロ用）"><pre
      class="sourceCode md"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># 指示  </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>現在ユーザーが操作中の Excel のアクティブシート（またはその親ブック）を対象に、「#やりたいこと」で指定された処理を行う「VBA のサブルーチン」を注意深く慎重に生成してください。</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu"># やりたいこと  </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>（ここに自然言語で、できるだけ具体的に処理内容を記述してください）</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu"># 実装前提  </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>以下の条件をすべて満たすようにコードを作成してください。</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>コードはアドインファイル（拡張子 <span class="in">`.xlam`</span>）の標準モジュールに記述することを前提とします。  </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Option Explicit`</span> は有効であるものとし、生成するコードには含めないでください。  </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>対象ブックは、<span class="in">`ActiveSheet.Parent`</span> を用いて取得してください（<span class="in">`ThisWorkbook`</span> は使用しないでください）。  </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>操作対象のワークシートは、原則として <span class="in">`ActiveSheet`</span> またはその親ブック内の全ワークシートとしてください。</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="fu"># コーディングガイドライン  </span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>処理前の状態（アクティブシート）を保存し、処理後に復元するコードを必ず含めてください。</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Application.ScreenUpdating = False`</span> など、画面更新の一時停止を可能な範囲で使用し、処理のパフォーマンスと視覚的ノイズの抑制に配慮してください。</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`On Error GoTo`</span> 構文を使い、エラー時には以下の処理を実行してください：</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>一時的に変更した <span class="in">`Application`</span> の設定を元に戻す。</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>エラー内容（<span class="in">`Err.Number`</span> と <span class="in">`Err.Description`</span>）を <span class="in">`MsgBox`</span> でユーザーに通知する。</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>必要に応じて <span class="in">`Debug.Print`</span> にエラーメッセージと発生箇所（プロシージャ名）を出力する。</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>エラーが発生しなかった場合は、<span class="in">`MsgBox`</span> による完了通知は不要です。</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>初心者にも理解できるように、各処理ブロックに日本語で簡潔かつ具体的なコメントを記述してください。</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>サブルーチンは <span class="in">`Public`</span> に設定し、日本語で機能が明確に伝わる命名（例：<span class="in">`全シートのカーソルをA1に戻す`</span>）をしてください。</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>クリップボードへのコピーには <span class="in">`CreateObject(&quot;Forms.TextBox.1&quot;)`</span> を使用し、次の点に注意してください：</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`.MultiLine = True`</span> を設定すること。</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`.Text`</span> を設定した後、<span class="in">`.SelStart = 0`</span> および <span class="in">`.SelLength = Len(.Text)`</span> を設定してから <span class="in">`.Copy`</span> を呼ぶこと。</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span><span class="in">`Nothing`</span> チェックを行い、作成失敗時の明確なエラーメッセージを含めてください。</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>グローバル変数の使用は禁止とし、すべての処理はサブルーチン内で完結してください。  </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>標準の Excel VBA 環境（外部参照設定なし）で動作するコードにしてください。</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="fu"># 補足</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>初回エラーが起きやすい箇所（＝オブジェクトの存在チェックや選択状態の変更など）には、予防的な <span class="in">`If`</span> や <span class="in">`Is Nothing`</span> チェックを挿入してください。</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`With`</span> や <span class="in">`For Each`</span> のブロックでは、途中で対象オブジェクトが変化しないことを前提に書いてください。</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>このプロンプトは VBA に不慣れなユーザーが使用することを想定しています。そのため、後から問題発生時に再質問しやすいよう**に、処理構成や例外処理を明確にしておいてください。</span></code></pre></div>
      <p>プロンプトが急に複雑になったように感じるかもしれませんが、基本的にみなさんが記述するのは
      <span class="masked">#やりたいこと</span> の部分だけです。その他の部分は <strong>テンプレート
      (雛形) として、そのまま使ってください</strong>。</p>
      <p>実際に、上記のプロンプトの「<strong>#
      やりたいこと</strong>」の内容を以下に差し替えて、生成AIに貼り付けて、送信してみてください。生成AIから回答が生成されるはずです。</p>
      <blockquote>
      <p>すべてのシートのカーソル位置をA1に揃えたい</p>
      </blockquote>
      <p>実行結果の一例を次に示します。以下のように「<i class="fa-solid fa-copy"></i>
      <strong>コピーする</strong>」をクリックすることで、VBAプログラムをクリップボードに取得することができます。</p>
      <figure>
      <img src="figs/gai-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="5.3" id="アドインにマクロを追加する"><span
      class="header-section-number">5.3</span> アドインにマクロを追加する</h2>
      <p>エクセルを起動して「空白のブック」を新規作成してください
      (既存のファイルのオープンでも問題ありません)。</p>
      <p>「<strong>開発</strong>」タブから「<strong>Visual
      Basic</strong>」のアイコンをクリックして「VBAエディタ」を起動してください。あるいは
      <code>[Alt]+[F11]</code>
      のショートカットで「<strong>VBAエディタ</strong>」を起動してください。</p>
      <p>次のように「<strong>マイアドイン.xlam</strong>」の「<strong>Module1</strong>」が選択されていることを確認して、先ほど記述した
      <code>Public Sub A1に乱数を書き込む処理()</code> ～ <code>End Sub</code>
      以降の行に、生成AIが出力したコードを貼り付けてください。</p>
      <figure>
      <img src="figs/excel-addin-16.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <div class="note type-caution">
      <p><strong>「Option Explicit」の重複に注意</strong></p>
      <p>生成AIに与えたプロンプトには <code>Option Explicit</code>
      を含めないように指示していますが、ときどき <code>Option Explicit</code>
      を出力してくることがあります。</p>
      <p>そのとき、以下のように <code>Option Explicit</code> を
      <strong>重複記述すると不具合の原因となるので注意</strong> してください。</p>
      <figure>
      <img src="figs/excel-addin-22.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      </div>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>エクセルマクロにおける <code>Option Explicit</code>
      とは何のために記述するものですか？生成AIにVBAを書かせる前提なのですが、書いておいた方がよいですか？</p>
      </blockquote>
      <h2 data-number="5.4" id="追加したマクロの動作チェック"><span
      class="header-section-number">5.4</span> 追加したマクロの動作チェック</h2>
      <p>追加したマクロが正常に動作するかチェックします。以下のように追加した処理 (ここでは
      <code>全シートのカーソルをA1に戻す</code>) を選択して「実行ボタン
      <i class="fa-solid fa-play"></i>」を押下してください。</p>
      <figure>
      <img src="figs/excel-addin-17.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>実際にエクセルブック (<code>Book1.xlsx</code>)
      のほうで「<strong>このマクロが意図した動作をしているか</strong>」を確認してください。問題なく動作することを確認できたら「<strong>VBAエディタ</strong>」の「保存
      <i class="fa-solid fa-floppy-disk"></i>」のボタンを押下してください。アドインファイルの更新内容が保存されます。</p>
      <figure>
      <img src="figs/excel-addin-23.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="5.4.1" id="もしマクロの実行時エラーが発生したときは"><span
      class="header-section-number">5.4.1</span>
      もし、マクロの「実行時エラー」が発生したときは…</h3>
      <p>VBAプログラムに問題があった場合、実行時に次のようなダイアログが表示されます。その場合は「<strong>OK</strong>」を押下してください。</p>
      <figure>
      <img src="figs/error-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>上記ダイアログの「<strong>OK</strong>」を押下すると「<strong>中断</strong>」という状態になります。通常の編集モードに戻るためには、下図のように「停止マーク」のボタンを押下してください。</p>
      <figure>
      <img src="figs/error-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>また「継続」「終了」「デバッグ」「ヘルプ」のボタンを持ったダイアログが表示されたときは「<strong>終了</strong>」を選択してください。また、無限ループが生じた際は
      <code>Escキー</code> の押下で抜けることができます。</p>
      <h3 data-number="5.4.2" id="実行に失敗したり意図した動作をしないときは"><span
      class="header-section-number">5.4.2</span> 実行に失敗したり、意図した動作をしないときは…</h3>
      <p>実行に失敗したり、意図した動作をしない場合は、もう一度、同じプロンプトを生成AIに与え、<strong>再生成されたコードに差し替えて実行してみること</strong>
      をお勧めします。</p>
      <p>それでもエラーがつづく場合は「<strong>イミディエイトウィンドウに表示されるエラーメッセージの内容</strong>」を、プロンプトに与えて修正依頼をすることで、問題を解決したコードが生成されることもあります。</p>
      <figure>
      <img src="figs/excel-addin-24.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>プロンプト例 (先のプロンプトにつづけて…)</p>
      <blockquote>
      <p>上記のVBAプログラムをエクセルのVBAエディタに貼り付けて実行したのですが、次のようなエラーが発生して意図する動作をしませんでした。注意深く慎重に改善してください。</p>
      <p>(ここにエラーの状況を詳しく説明する文章)</p>
      </blockquote>
      <h2 data-number="5.5" id="追加したマクロをリボンに登録"><span
      class="header-section-number">5.5</span> 追加したマクロをリボンに登録</h2>
      <p>エクセル (≠VBAエディタ)
      の「<strong>ファイル</strong>」から「<strong>オプション</strong>」を選択し、「<strong>リボンのユーザー設定</strong>」から以下の手順で追加したマクロ
      (例えば <code>全シートのカーソルをA1に戻す</code> の処理) をリボンに登録してください。</p>
      <figure>
      <img src="figs/excel-addin-18.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のように追加したマクロがリボン上に登録され、任意のタイミングでマクロを呼び出すことができるようになります。</p>
      <figure>
      <img src="figs/excel-addin-19.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>また、次のような手順で、リボンに表示する際のマクロの「<strong>アイコン</strong>」と「<strong>名前</strong>」を変更することもできます。</p>
      <figure>
      <img src="figs/excel-addin-25.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>アイコンと表示名を変更した例を以下に示します。</p>
      <figure>
      <img src="figs/excel-addin-26.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="5.6" id="さらにマクロを追加"><span class="header-section-number">5.6</span>
      さらにマクロを追加</h2>
      <p>マクロを追加登録によって「<strong>Module1</strong>」が肥大化したときは、次の手順でモジュールを追加し、そこにVBAプログラムを貼付けてください。</p>
      <figure>
      <img src="figs/excel-addin-27.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以下は、新たに追加した「<strong>Module2</strong>」に対してVBAプログラムを記述する画面です。</p>
      <figure>
      <img src="figs/excel-addin-28.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h1 data-number="6" id="演習個別質問対応"><span class="header-section-number">6</span>
      演習＆個別質問対応</h1>
      <p>以上で基本的な解説は終了です。</p>
      <p>学んだ内容を定着させるために、次のようなマクロ (VBAプログラム)
      を生成AIに作成させて、アドインに追加、動作確認をしてみてください。</p>
      <ol type="1">
      <li>すべてのシートについて、表示倍率を100%にする</li>
      <li>選選択しているセルに対して、次の設定を行う
      <ul>
      <li>表示形式：小数点以下1桁までの数値表示に固定する</li>
      <li>条件付き書式：負の数を赤色で表示する</li>
      </ul></li>
      <li>アクティブシートのなかで選択しているセルを含む行を非表示にする</li>
      <li>アクティブなブックに存在するすべてのワークシートの名前をクリップボードに取得したい</li>
      <li><strong>(その他、皆様の日常的なエクセル業務のなかでの定型作業)</strong></li>
      </ol>
      <p>講師が巡回するので、ここまでの内容で分からないことや、相談したいことがあれば、気軽に声をかけてください。</p>
      <figure>
      <img src="figs/image-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="6.1" id="プロンプト記述のポイント"><span
      class="header-section-number">6.1</span> プロンプト記述のポイント💡</h2>
      <p>VBAコードを期待通りに生成させるためには、「何をどうしたいのか」を生成AIに<strong>正確に伝えることが重要</strong>です。以下のポイントを参考に、プロンプトを工夫してみてください。</p>
      <h3 data-number="6.1.1" id="処理対象を明示する"><span
      class="header-section-number">6.1.1</span> 1. 処理対象を明示する</h3>
      <p>どの要素に対して操作を行うのかを、明示してください。</p>
      <ul>
      <li>選択しているセルに対して…</li>
      <li>アクティブシートに対して…</li>
      <li>すべてのワークシートに対して…</li>
      <li>選択中のグラフに対して…</li>
      <li>アクティブシートが属するブック全体に対して…</li>
      </ul>
      <h3 data-number="6.1.2" id="具体例を入れる"><span class="header-section-number">6.1.2</span>
      2. 具体例を入れる</h3>
      <p>具体的なデータ例を示すことで、生成されるコードの精度が上がります。</p>
      <ul>
      <li>「令和7年04月01日(火)」のような日付形式で…</li>
      <li>「0.890%」のような、小数点以下3桁のパーセント表示で…</li>
      </ul>
      <h3 data-number="6.1.3" id="目的や背景を伝える"><span
      class="header-section-number">6.1.3</span> 3. 目的や背景を伝える</h3>
      <p>なぜその処理を行いたいのかを書くことで、意図に沿ったコードが得られやすくなります。</p>
      <ul>
      <li>表示を整えて見やすくするために…</li>
      <li>入力ミスを防ぐために…</li>
      <li>分析時にフィルターで並べ替えやすくするために…</li>
      </ul>
      <h3 data-number="6.1.4" id="上書きか追加かを明確に"><span
      class="header-section-number">6.1.4</span> 4. 「上書き」か「追加」かを明確に</h3>
      <p>既存の設定を残したいのか、それともすべて置き換えたいのかは、明確に記述しましょう。</p>
      <ul>
      <li>既存の条件付き書式を <strong>そのまま残しつつ</strong>、新しい条件付き書式を
      <strong>追加したい</strong></li>
      <li>既存の条件付き書式を <strong>すべて削除して</strong>、新たに条件付き書式を
      <strong>設定し直したい</strong></li>
      <li>既存の表示形式はそのままで、<strong>条件付き書式のみ追加したい</strong></li>
      </ul>
      <h3 data-number="6.1.5" id="雛形を柔軟に活用"><span class="header-section-number">6.1.5</span>
      5. 雛形を柔軟に活用</h3>
      <p>プロンプトの <a href="#マクロ-vbaプログラム-の作成依頼プロンプト例-②">雛形</a>
      を使えば、アドインに適した形式のコードが得られやすくなります。ただし、処理内容によっては提供した雛形が適さない場合もあります
      (柔軟に使い分けてください)。</p>
      <h1 data-number="7" id="ネクストステップ"><span class="header-section-number">7</span>
      ネクストステップ</h1>
      <p>このセミナーで学んだ内容を実務に活かすには、生成AIをうまく使いながら、自分なりの課題に取り組んでいくことが大切です。基本的な操作ができるようになると「<strong>アドインを他の人にも配布するには？</strong>」や「<strong>アドインではなく、特定のファイルに直接マクロを埋め込みたい</strong>」といった、次のステップが見えてくるはずです。</p>
      <p>その際には、生成AIに相談しながら、少しずつ実践の幅を広げていくのがおすすめです。以下に、実務で役立つプロンプト例をいくつか紹介します。</p>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>先日、あるセミナー ( https://takeshiwada1980.github.io/excel-macro/ )
      に参加して、エクセルでアドインファイルを作成し、それにマクロを記述 (生成AIでコードを作成)
      し、リボンタブに登録したアイコンからマクロを呼び出す、という方法を学んできました。今度は、アドインファイルではなく、個々のエクセルファイルのなかにマクロを記述して実行するというのをやってみたいです。これは難しいですか。また、この方法ではどんな点に注意すべきですか？</p>
      </blockquote>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>エクセルでアドイン (<code>*.xlam</code>)
      を作成して、そのなかに社内業務で役立つマクロを作成してみました。このアドインファイルを同僚に配って使ってもらいたいと思っているのですが、どのようにすればよいですか？また、その際の注意点や、よくあるトラブル
      (起動しない、毎回警告が表示されるなど) と対処法について教えてください。</p>
      </blockquote>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>先日、あるセミナー ( https://takeshiwada1980.github.io/excel-macro/ )
      に参加してきました。それ以降、エクセルマクロを使った業務効率化に関心があります。このセミナーでは触れられていないことで、何か知っておくと便利な機能や、マクロを使ってできることについて教えてください。</p>
      </blockquote>
      <h1 data-number="8" id="補足"><span class="header-section-number">8</span> 補足</h1>
      <p>マクロを利用する際に気をつけたい、セキュリティに関する重要事項について説明しておきます。</p>
      <figure>
      <img src="figs/image-04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="8.1" id="マクロを利用するときの注意点"><span
      class="header-section-number">8.1</span> マクロを利用するときの注意点</h2>
      <p>VBAによるマクロは、それが組み込まれたExcelファイルの内部データ（シートやセル）を操作するだけではなく、<strong>Officeアプリとは無関係のファイルを対象とする操作</strong>や
      <span class="masked">インターネット通信、別のプログラムの起動</span>
      も可能となっています。</p>
      <p>つまり、<strong>悪意のあるマクロ</strong>
      は、ユーザのドキュメントフォルダを全消去したり、インターネットからマルウェア (ウイルスなどい)
      をダウンロードして実行したりすることも可能となっています。そのため、<strong>信頼できないファイルに付属するマクロの取扱い（実行許可の可否判断）には十分に注意</strong>
      してください。</p>
      <h2 data-number="8.2" id="マクロ有効ブックのオープン"><span
      class="header-section-number">8.2</span> マクロ有効ブックのオープン</h2>
      <p>自分以外が作成した<strong>マクロ有効ブック</strong>（＝マクロを含む Excel
      ドキュメント）を開こうとすると、次のような<strong>赤色の警告</strong>
      が表示され、マクロが自動でブロック（無効化）されることがあります。</p>
      <figure>
      <img src="figs/macro-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>このドキュメントについて、マクロを有効化したい場合は、そのファイルを一旦閉じてから、エクスプローラで対象ファイルを右クリックして「<strong>プロパティ</strong>」を選択し、タブ「<strong>全般</strong>」の下部にある「<strong>セキュリティ</strong>」の項目の「<strong>許可する</strong>」にチェックをいれてください。</p>
      <figure>
      <img src="figs/macro-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>また、ファイルの作成者に関わらずマクロを含むExcelドキュメントを開くと、以下のようにマクロが自動で無効化されることがあります（<strong>黄色の警告</strong>）。そのファイルでマクロを有効化するためには「<strong>コンテンツの有効化</strong>」のボタンをクリックしてください。</p>
      <figure>
      <img src="figs/macro-03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以上のようなマクロに関連する「<strong>警告表示</strong>」や「<strong>自動ブロック</strong>」は、設定のなかの「<strong>トラストセンター}</strong>」という項目から変更することができます。どうしてもマクロ付きExcelドキュメントが有効化できない場合などは、次の手順で「トラストセンターの設定」を確認・変更してください。</p>
      <ol type="1">
      <li>Excelの「<strong>ファイル</strong>」から「<strong>オプション</strong>」を選択して「<strong>Excelのオプション</strong>」のダイアログを表示してください。</li>
      <li>ダイアログの左側のメニューから「<strong>トラストセンター</strong>」を選択して、「<strong>トラストセンターの設定</strong>」をクリックしてください。</li>
      </ol>
      <figure>
      <img src="figs/macro-04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <ol start="3" type="1">
      <li>トラストセンターのダイアログの左側のメニューから「<strong>マクロの設定</strong>」を選択して、項目の設定を変更してください。</li>
      </ol>
      <figure>
      <img src="figs/macro-05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「<strong>マクロの設定</strong>」の項目は、以下のように「<strong>警告して、VBAマクロを無効にする</strong>」を選んでおくことをお勧めします。
      以上の設定を変更してもマクロが有効化されない場合は、ウィルス対策ソフトウェアの設定などを確認してください（詳細については各自でウェブ検索してください）。</p>
      <h1 data-number="9" id="おまけ-notebooklm-で音声概要を生成する方法"><span
      class="header-section-number">9</span> おまけ: NotebookLM で音声概要を生成する方法</h1>
      <p>Google の NotebookLM
      というウェブサービスを使って、<strong>任意のウェブサイトの音声概要を生成する手順</strong>
      を紹介します（2025年5月に多言語対応した比較的新しい機能です）。なお、ここでは、ウェブサイトの
      URL を入力して音声概要を作成する方法を紹介しますが、URL に限らず PDF
      などのファイルを読み込ませて概要を生成することも可能です。</p>
      <div class="note type-tips">
      <p><strong>Google NotebookLM とは</strong></p>
      <p>NotebookLM は、<strong>与えられた資料をもとに要約や説明を生成してくれる Google
      のウェブサービス</strong>です。特徴的なのは、資料をもとに質問に答えてくれる「対話機能」がある点です。たとえば、「この文章のポイントは？」とか「登場する人物の関係を教えて」などと自然な言葉で聞くと、NotebookLM
      が資料を読み取って回答してくれます。</p>
      </div>
      <h2 data-number="9.1" id="手順1-3"><span class="header-section-number">9.1</span> 手順1</h2>
      <p>Google アカウント (個人のものでOK) にログインしている状況で<a
      href="https://notebooklm.google.com/">https://notebooklm.google.com/</a>にアクセスしてください。利用規約が表示された場合、内容を確認して問題がなければ同意してください
      (初回のみ)。</p>
      <figure>
      <img src="figs/notebook-lm-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="9.2" id="手順2-3"><span class="header-section-number">9.2</span> 手順2</h2>
      <p>画面下部の「<strong>＋ノートブックを新規作成</strong>」のボタンを押下してください。</p>
      <figure>
      <img src="figs/notebook-lm-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="9.3" id="手順3-3"><span class="header-section-number">9.3</span> 手順3</h2>
      <p>次のように「<strong>ウェブサイト</strong>」を選択してください。</p>
      <figure>
      <img src="figs/notebook-lm-03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="9.4" id="手順4-1"><span class="header-section-number">9.4</span> 手順4</h2>
      <p>要約したい「<strong>ウェブサイト</strong>」のURLをテキストボックスに貼り付けてください。例えば、貴社のウェブサイトのURLなどを入力してみと面白いかもしれません。URLを入力したら画面右下の「<strong>挿入</strong>」を押下してください。</p>
      <figure>
      <img src="figs/notebook-lm-04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="9.5" id="手順5"><span class="header-section-number">9.5</span> 手順5</h2>
      <p>指定したURLの情報が読み込まれるので、<strong>Studio</strong>
      のなかの「音声概要」の「詳細な会話
      2人のホスト」の「<strong>生成</strong>」を押下してください。ウェブブラウザのウィンドウ幅が狭い場合は、Studio
      のパネルが隠れている可能性があります。</p>
      <figure>
      <img src="figs/notebook-lm-05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <ul>
      <li>生成された音声ファイルはダウロードすることができます。</li>
      <li>無料のGoogleアカウントであれば、<strong>1日3回</strong>まで「音声概要の生成」が利用できます
      (使い切った場合は、翌日に再チャレンジしてください)。</li>
      </ul>
      <p>音声概要の生成は、NotebookLM のひとつの機能に過ぎません。YouTube では NotebookLM
      の様々な活用方法が提案・されていますので、興味のある方は そちらをご覧ください。</p>
      <ul>
      <li><a
      href="https://www.youtube.com/results?search_query=NotebookLM">YouTubeで「NotebookLM」について検索</a></li>
      </ul>
      <hr />
      <p><i class="fa-regular fa-copyright"></i> 2025 Takeshi Wada. All rights reserved.</p>
      <!-- ---------------------------------------- -->
    </main>

    <footer class="markdown-body">
      <p><a href="https://takeshiwada1980.github.io/excel-macro/">講義資料のIndexに移動</a></p>
    </footer>

    <script>
      window.onload = function () {
        // ナビゲーション関連
        let openBtn = document.getElementsByClassName("openbtn")[0];
        let navPnl = document.getElementById("g-nav");
        openBtn.onclick = () => {
          openBtn.classList.toggle("active");
          navPnl.classList.toggle("panelactive");
        };

        let items = navPnl.getElementsByTagName("a");
        Array.from(items).forEach((item) => {
          item.onclick = () => {
            openBtn.classList.toggle("active");
            navPnl.classList.toggle("panelactive");
          };
        });

        // マスク処理
        let maskedSpans = document.getElementsByClassName("masked");
        Array.from(maskedSpans).forEach((span) => {
          span.onclick = () => {
            span.classList.toggle("open");
          };
        });

        // data-startfrom 属性の行番号カウンタのリセット
        document.querySelectorAll("div.sourceCode").forEach(function (div) {
          var startFrom = div.getAttribute("data-startfrom");
          if (startFrom != null) {
            div.style.counterReset = "pg-line " + (startFrom - 1);
          }
        });

        // 画像にリンクを付与
        // let images = document.querySelectorAll("figure img");
        // Array.from(images).forEach((img) => {
        //   img.onclick = () => {
        //     location.href = img.getAttribute("src");
        //   };
        // });
      };
    </script>
  </body>
</html>
