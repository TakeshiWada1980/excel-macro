<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <meta name="robots" content="noindex,nofollow,noarchive" />
    <meta name="referrer" content="no-referrer" />

    <script>
      MathJax = {
        chtml: {
          displayAlign: "left",
          displayIndent: "1em",
        },
      };
    </script>

    

    <link rel="icon" href="favicon.ico" sizes="any" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c"
    />
    <link rel="stylesheet" href="style.css" />

    <title>生成AI×Excel ～身近なExcel業務から始めるAI活用～</title>
  </head>

  <body>
    <div class="openbtn"><span></span><span></span><span></span></div>
    <nav id="g-nav">
      <div id="g-nav-list">
        <!-- ---------------------------------------- -->
         <ul>
<li><a href="#第15回-技術実践セミナー" id="toc-第15回-技術実践セミナー"><span
class="toc-section-number">1</span> 第15回 技術実践セミナー</a>
<ul>
<li><a href="#注意事項" id="toc-注意事項"><span class="toc-section-number">1.1</span>
注意事項</a></li>
</ul></li>
<li><a href="#生成aiの利用準備" id="toc-生成aiの利用準備"><span class="toc-section-number">2</span>
生成AIの利用準備</a>
<ul>
<li><a href="#プロンプトを入力する際の注意点" id="toc-プロンプトを入力する際の注意点"><span
class="toc-section-number">2.1</span> プロンプトを入力する際の注意点</a></li>
</ul></li>
<li><a href="#エクセルのマクロとは" id="toc-エクセルのマクロとは"><span
class="toc-section-number">3</span> エクセルの「マクロ」とは</a>
<ul>
<li><a href="#マクロを作成する方法" id="toc-マクロを作成する方法"><span
class="toc-section-number">3.1</span> マクロを作成する方法</a></li>
<li><a href="#準備-①-エクセルのリボン設定" id="toc-準備-①-エクセルのリボン設定"><span
class="toc-section-number">3.2</span> 準備 ① (エクセルのリボン設定)</a></li>
<li><a href="#準備-②-vbaエディタの設定" id="toc-準備-②-vbaエディタの設定"><span
class="toc-section-number">3.3</span> 準備 ② (VBAエディタの設定)</a></li>
</ul></li>
<li><a href="#アドインファイルの新規作成と登録" id="toc-アドインファイルの新規作成と登録"><span
class="toc-section-number">4</span> アドインファイルの新規作成と登録</a></li>
<li><a href="#生成aiにマクロを作成させる" id="toc-生成aiにマクロを作成させる"><span
class="toc-section-number">5</span> 生成AIにマクロを作成させる</a>
<ul>
<li><a href="#マクロ-vbaプログラム-の作成依頼プロンプト例-①"
id="toc-マクロ-vbaプログラム-の作成依頼プロンプト例-①"><span class="toc-section-number">5.1</span>
マクロ (VBAプログラム) の作成依頼プロンプト例 ①</a></li>
<li><a href="#マクロ-vbaプログラム-の作成依頼プロンプト例-②"
id="toc-マクロ-vbaプログラム-の作成依頼プロンプト例-②"><span class="toc-section-number">5.2</span>
マクロ (VBAプログラム) の作成依頼プロンプト例 ②</a></li>
<li><a href="#アドインにマクロを追加する" id="toc-アドインにマクロを追加する"><span
class="toc-section-number">5.3</span> アドインにマクロを追加する</a></li>
<li><a href="#追加したマクロの動作チェック" id="toc-追加したマクロの動作チェック"><span
class="toc-section-number">5.4</span> 追加したマクロの動作チェック</a></li>
<li><a href="#追加したマクロをリボンに登録" id="toc-追加したマクロをリボンに登録"><span
class="toc-section-number">5.5</span> 追加したマクロをリボンに登録</a></li>
<li><a href="#さらにマクロを追加" id="toc-さらにマクロを追加"><span
class="toc-section-number">5.6</span> さらにマクロを追加</a></li>
</ul></li>
<li><a href="#演習" id="toc-演習"><span class="toc-section-number">6</span> 演習</a></li>
<li><a href="#補足-マクロ有効ブックのオープン" id="toc-補足-マクロ有効ブックのオープン"><span
class="toc-section-number">7</span> 補足: マクロ有効ブックのオープン</a></li>
<li><a href="#補足-マクロを利用するときの注意点" id="toc-補足-マクロを利用するときの注意点"><span
class="toc-section-number">8</span> 補足: マクロを利用するときの注意点</a></li>
</ul> 
        <!-- ---------------------------------------- -->
      </div>
    </nav>

    <header class="markdown-body">
      <p>産学連携推進会 第15回 技術実践セミナ－</p>
      <p>2025年6月12日(木) 15:00-16:30</p>
    </header>

    <main class="markdown-body">
      <!-- ---------------------------------------- -->
      <h1 data-number="1" id="第15回-技術実践セミナー"><span class="header-section-number">1</span>
      第15回 技術実践セミナー</h1>
      <ul>
      <li><strong>日時</strong> : 2025年06月12日（木）15:00～16:30</li>
      <li><strong>場所</strong> : 公大高専 地域連携テクノセンター 2階 CAD室</li>
      <li><strong>講師</strong> : 知能情報コース 教授  和田 健 (Takeshi Wada)</li>
      <li><strong>テーマ</strong> : 生成AI×Excel ～身近なExcel業務から始めるAI活用～</li>
      </ul>
      <h2 data-number="1.1" id="注意事項"><span class="header-section-number">1.1</span>
      注意事項</h2>
      <ul>
      <li>PC保護のため飲食は、廊下においてお願いします。
      <ul>
      <li><strong>机上には「水筒」や「ペットボトル」を置かない</strong>ようにご協力をお願いします。</li>
      </ul></li>
      <li>卓上の「電源コンセント」はご自由にお使いください。</li>
      <li>このウェブページのURLについては、セミナー終了後、<strong>社内で共有いただいて問題ございません</strong>。</li>
      <li>休憩時間は設けませんので、適宜、水分補給や御手洗をご利用ください。</li>
      </ul>
      <h1 data-number="2" id="生成aiの利用準備"><span class="header-section-number">2</span>
      生成AIの利用準備</h1>
      <p>普段からご利用の生成AIサービスがございましたら、事前にウェブブラウザからログインしていただくようお願いします。なお、以下でご紹介する生成AIについては、アカウント登録なしでご利用いただけます。</p>
      <ul>
      <li>ChatGPT <a href="https://openai.com/ja-JP/">https://openai.com/ja-JP/</a></li>
      <li>Gemini <a href="https://gemini.google.com">https://gemini.google.com</a></li>
      </ul>
      <h2 data-number="2.1" id="プロンプトを入力する際の注意点"><span
      class="header-section-number">2.1</span> プロンプトを入力する際の注意点</h2>
      <p>このセミナーでは「生成AI」を利用します。生成AIに対して与える指示文を「プロンプト」と言います。</p>
      <p>プロンプトを与える際に、入力ボックスのなかで「<strong>改行したいとき</strong>」は
      <code>[Shift]+[Enter]</code> を使ってください。<code>[Enter]</code>
      ではプロンプトの「<strong>送信</strong>」になってしまいます。</p>
      <figure>
      <img src="figs/gai-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <div class="note type-tips">
      <p><strong>[Enter] で改行したいときは</strong></p>
      <p>ChatGPT や Gemini、Claude などの生成AIサイトのなかで…</p>
      <ul>
      <li><code>[Enter]</code> で「<strong>改行</strong>」</li>
      <li><code>[Ctrl]+[Enter]</code> で「<strong>プロンプト送信</strong>」</li>
      </ul>
      <p>…動作を切り替えたいときは、以下の拡張機能 (Chrome対応) が便利です。</p>
      <p><a
      href="https://chromewebstore.google.com/detail/chatgpt-ctrl+enter-sender/gbncgdhklmnckojlibfhdadpfbcdbnch">ChatGPT
      Ctrl+Enter Sender</a></p>
      <blockquote>
      <p>ChatGPTなどのAIチャットサービスでのメッセージ送信を「Ctrl+Enter」に割り当て、誤送信を防ぎます。Enterキーで改行できるため直感的に操作可能です。</p>
      <p>ChatGPT Ctrl+Enter
      Senderは、ChatGPTなどのサイトでメッセージを「Ctrl+Enter」で送信できるようにします。
      本来送信に使用されていたEnterキーで改行できるようになるため、誤ってEnterキーを押してメッセージを送信することがなくなります。</p>
      </blockquote>
      <p>なお、セミナー会場の PC では、セキュティポリシーの都合上、<strong>Chrome
      の拡張機能をインストールすることは「できません」</strong>。</p>
      </div>
      <h1 data-number="3" id="エクセルのマクロとは"><span class="header-section-number">3</span>
      エクセルの「マクロ」とは</h1>
      <p>エクセルにおける「<strong>マクロ
      (Macro)</strong>」とは、各種作業を自動化・効率化するために用意されている標準機能のひとつになります。マクロを利用することで、次のような定型処理が「<strong>ワンクリック</strong>」で実行できるようになります。</p>
      <ul>
      <li>すべてのシートについて、カーソル位置をA1に設定して表示倍率を100%にする</li>
      <li>すべてのシートについて、印刷範囲と改ページ位置を一括設定する</li>
      <li>選択しているグラフのサイズを横5cm、縦3cmに設定し、0.75ptの黒枠線を設定する</li>
      <li>選択しているセルに対して、任意の表示形式 (例：<span
      class="masked">小数点桁数を1に固定</span>) と条件付き書式 (例：<span
      class="masked">負の数は赤色表示</span>) を同時設定する</li>
      </ul>
      <p>繰り返しの多い定型作業については、多少面倒でも面倒でもマクロを作成しておくことで長期的には「効率アップ」「ミス軽減」「ストレス軽減」となります。是非、積極的に利用してください。</p>
      <p>なお、マクロとは「<strong>一連の操作や手続きを自動化するための命令の集まりや機能</strong>」をあらわす一般的な用語で、エクセルに限らず、「ワード」や「パワーポイント」などのオフィス製品でも同様に設定・利用ができます。</p>
      <p><strong>(プロンプト例)</strong></p>
      <blockquote>
      <p>エクセ以外にも、ワードやパワーポイントでもマクロが利用できると聞いたのですが本当ですか？総務関連の業務を想定したとき、どのようなことをワードでマクロ化すると便利そうですか？</p>
      </blockquote>
      <h2 data-number="3.1" id="マクロを作成する方法"><span class="header-section-number">3.1</span>
      マクロを作成する方法</h2>
      <p>マクロの実体は、「<strong>VBA (Visual Basic for
      Applications)</strong>」というプログラミング言語で書かれたプログラムとなっています。</p>
      <p>エクセルでは、次のいずれかの方法でマクロを作成することができます。</p>
      <p><strong>【方法1】</strong>
      エクセルから「<strong>VBAエディタ</strong>」を起動して、VBAのプログラムを自分で打ち込む</p>
      <p><strong>【方法2】</strong> エクセルの「<strong>マクロの記録</strong> (下図参照)
      」という機能で作業や操作を記録して、それをVBAプログラムに自動変換する</p>
      <figure>
      <img src="figs/excel-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p><strong>【方法2】</strong> は、初心者でも簡単に使える反面、<span
      class="masked">実行条件が少し変わるだけで意図どおりに動かなく</span>
      なったり、<strong>余計な操作まで記録されてしまったりする</strong>など、汎用性や柔軟性に問題があり、利用できる場面が限られてします。</p>
      <p>また<strong>【方法1】</strong>については、「<strong>(基礎的な)
      プログラミングの知識やスキル</strong>」が必要であるため、多くの人々 (＝プログラミング未経験者)
      には敷居が高いものでした。</p>
      <p>しかし、最近では ChatGPT
      などの「<strong>生成AI</strong>」を利用することで、エクセルの基礎知識
      (＝「セル」や「シート」といった用語の知識) があれば、<strong>【方法1】</strong>
      で実用マクロが作成できるようになってきました。</p>
      <p>今回のセミナでは、マクロの本体である「VBAプログラム」の作成は
      <strong>全て生成AIに任せる</strong> という前提で、<span
      class="masked">生成AIが出力したVBAプログラムをマクロとして設定する方法</span> や、
      <strong>リボンにボタンを配置して、そこからマクロを呼び出す方法</strong>
      などを中心にハンズオン形式 (＝実際の操作を体験する形式) で学んでいきます。</p>
      <p>あわせて、トラブルの少ないマクロを安定して生成するためのプロンプトの書き方（雛形付き）についても紹介していきます。</p>
      <h2 data-number="3.2" id="準備-①-エクセルのリボン設定"><span
      class="header-section-number">3.2</span> 準備 ① (エクセルのリボン設定)</h2>
      <p>初回のみ必要な設定です。</p>
      <p>次に示すように、エクセルの「<strong>開発</strong>」タブから「<strong>コード</strong>」のカテゴリグループにアクセスできるようにしていきます。「開発」タブは、VBAプログラムの書き込みに使用する「<strong>VBAエディタ</strong>」の起動などに使用します。</p>
      <figure>
      <img src="figs/excel-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>デフォルト状態 (標準状態・初期状態)
      のエクセルでは、<strong>「開発」タブが非表示になっていることが多いの</strong>で、まずは、これが表示されるように設定変更していきます。</p>
      <h3 data-number="3.2.1" id="手順1"><span class="header-section-number">3.2.1</span> 手順1</h3>
      <p>エクセルを起動し、(必要に応じて「空白のブック」を選択したあとに)
      メニューバーの「<strong>ファイル</strong>」から「<strong>オプション</strong>」を選択してください。</p>
      <figure>
      <img src="figs/excel-09.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>全画面表示でない場合は「<strong>オプション</strong>」の項目が隠れているので、「<strong>ファイル</strong>」から「<strong>その他…</strong>」を選択して「<strong>オプション</strong>」を選択してください。</p>
      <h3 data-number="3.2.2" id="手順2"><span class="header-section-number">3.2.2</span> 手順2</h3>
      <p>「Excelのオプション」というダイアログが表示されるので、左パネルから「<strong>リボンのユーザ設定</strong>」を選択して、以下のように「<strong>開発</strong>」という項目にチェックを入れてください。</p>
      <figure>
      <img src="figs/excel-03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="3.2.3" id="手順3"><span class="header-section-number">3.2.3</span> 手順3</h3>
      <p>ダイアログを閉じて、画面上部のタブに「<strong>開発</strong>」が表示されていることを確認してください。この設定により、次回起動時にも「<strong>開発</strong>」タブが自動的に表示されるようになります。</p>
      <h2 data-number="3.3" id="準備-②-vbaエディタの設定"><span
      class="header-section-number">3.3</span> 準備 ② (VBAエディタの設定)</h2>
      <p>生成AIから出力したVBAプログラムを貼付ける「<strong>VBAエディタ</strong>」の基本設定をしてきます。これも初回のみ必要な設定となります。</p>
      <p>「<strong>開発</strong>」タブから「<strong>Visual
      Basic</strong>」のアイコンをクリックしてください。</p>
      <figure>
      <img src="figs/excel-04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「<strong>Visual
      Basic</strong>」のアイコンをクリックすると、以下のようなVBAプログラムを貼付けたり、マクロの実行テストをするためのウィンドウが起動します。</p>
      <figure>
      <img src="figs/excel-05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以降、このウィンドウを「<strong>VBAエディタ</strong>」と呼びます。VBAエディタは
      <code>[Alt]+[F11]</code> のショートカットキーからも呼び出すこともできます。</p>
      <p>以下、「VBAエディタ」の設定を変更していきます。</p>
      <h3 data-number="3.3.1" id="手順1-1"><span class="header-section-number">3.3.1</span>
      手順1</h3>
      <p>VBAエディタのメニューバーから「<strong>ツール</strong>」、「<strong>オプション</strong>」を選択してください。</p>
      <figure>
      <img src="figs/excel-10.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="3.3.2" id="手順2-1"><span class="header-section-number">3.3.2</span>
      手順2</h3>
      <p>「<strong>オプション</strong>」ダイアログの「<strong>編集</strong>」タブの設定を次のように設定してください。</p>
      <figure>
      <img src="figs/excel-06.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="3.3.3" id="手順3-1"><span class="header-section-number">3.3.3</span>
      手順3</h3>
      <p>VBAエディタの <strong>画面レイアウト</strong>
      を次のように「<strong>プロジェクトエクスプローラ</strong>」と「<strong>イミディエイトウィンドウ</strong>」だけが表示されるように変更していきます。</p>
      <figure>
      <img src="figs/excel-07.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>デフォルト状態のVBAエディタに表示されている余計なウィンドウ群は、<i class="fa-solid fa-rectangle-xmark"></i>
      ボタンで閉じてください。デフォルトでは「<strong>プロパティウィンドウ</strong>」が表示されていると思うので、これを閉じます。</p>
      <p>また、不足してウィンドウがあれば、メニューの「<strong>表示</strong>」から項目を選んで表示してください。デフォルト状態では「<strong>イミディエイトウィンドウ</strong>」が非表示になっている可能性があります。</p>
      <figure>
      <img src="figs/excel-08.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以上の設定が完了したらVBAエディタを閉じて、Excel本体も、一旦、完全終了してください。</p>
      <h1 data-number="4" id="アドインファイルの新規作成と登録"><span
      class="header-section-number">4</span> アドインファイルの新規作成と登録</h1>
      <p>エクセルのマクロは、個別のエクセルファイル (ブック) に記述することも、エクセル本体
      (より正確には<strong>アドイン</strong>) に記述することもできます。</p>
      <p><strong>【個別のエクセルファイルに記述したマクロ】</strong>は、基本的にそのファイルのなかでしか使用できません（またファイルは「<strong>マクロ有効ブック</strong>」として保存する必要があります）。</p>
      <p>一方、<strong>【アドインとして登録したマクロ】</strong>は、どのファイルからでも呼びだすことができて、マクロを含まない通常のファイル形式のまま作業を行なうことができます。</p>
      <div class="note type-caution">
      <p><strong>マクロ有効ブックとは</strong></p>
      <p>マクロを含むエクセルファイルは、必ず <strong>マクロ有効ブック</strong>
      (<code>*.xlsm</code>) として保存する必要があります。
      マクロを含んだままでは、普通のエクセル形式 (<code>*.xlsx</code>)
      で保存することはできません。</p>
      <p>また、マクロ有効ブックは、セキュリティ上の理由から、開くときに警告が表示されたり、メール添付すると「迷惑メール」として判定されてしまうことがあります。</p>
      <figure>
      <img src="figs/excel-11.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      </div>
      <p>このセミナーでは「<strong>すべてのシートのカーソル位置をA1にそろえる</strong>」や「<strong>選択セルに条件付き書式を素早く適用する</strong>」といった、様々な場面で共通する定型作業のマクロを扱うため、<span
      class="masked">エクセル本体 (アドイン)</span>
      にマクロを記述する方法について解説していきます。</p>
      <p>アドインとは「<strong>よく使うマクロをエクセルに「常備」しておくための仕組み</strong>」です。以下、<strong>アドイン専用ファイル</strong>
      (<code>*.xlam</code>)
      にマクロを記述して、エクセルの起動時にそれらが自動で読み込まれるように設定していきます。</p>
      <p>これも、基本的に初回のみ必要な作業になります。</p>
      <h3 data-number="4.0.1" id="手順1-2"><span class="header-section-number">4.0.1</span>
      手順1</h3>
      <p>全てのエクセル (ファイルやウィンドウ)
      が「<strong>閉じられていること</strong>」を確認してください。</p>
      <p>スタートボタンからエクセルを起動してください
      (何らかのファイルをダブルクリックして起動するのではなく、スタートボタンやタスクバーからエクセルを起動してください)。</p>
      <h3 data-number="4.0.2" id="手順2-2"><span class="header-section-number">4.0.2</span>
      手順2</h3>
      <p>エクセルが起動したら、以下のように「<strong>新規</strong>」から「<strong>空白ブック</strong>」をクリックしてください。なお、起動時に自動で空白のブックが新規作成される設定になっている場合は、この操作は不要です
      (次の手順に進んでください)。</p>
      <figure>
      <img src="figs/excel-addin-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「<strong>Book1</strong>」という新規ファイルが作成されます。なお、状況によってはファイル名が「Book2」や「Book3」になる場合もありますが問題ありません。</p>
      <figure>
      <img src="figs/excel-addin-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="4.0.3" id="手順3-2"><span class="header-section-number">4.0.3</span>
      手順3</h3>
      <p>「<strong>開発</strong>」タブから「<strong>Visual
      Basic</strong>」のアイコンをクリックして「<strong>VBAエディタ</strong>」を起動してください。あるいは
      <code>[Alt]+[F11]</code>
      のショートカットで「<strong>VBAエディタ</strong>」を起動してください。</p>
      <figure>
      <img src="figs/excel-04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以下のように「<strong>プロジェクト</strong>」ウィンドウのなかの「<strong>VBAProject
      (Book1)</strong>」を右クリックして、「<strong>挿入</strong>」-「<strong>標準モジュール</strong>」を選択してください。</p>
      <figure>
      <img src="figs/excel-addin-03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以下のように「標準モジュール」のなかに「<strong>Module1</strong>」という領域
      (＝VBAプログラムを記述する箇所) が作成されます。また「Book1
      Module1」というコードウィンドウが開きます。コードウィンドウには <code>Option Explicit</code>
      と記述されています (あとで、これにつづけて VBA プログラムを貼付けます)。</p>
      <figure>
      <img src="figs/excel-addin-04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>上記のようにウィンドウが最大化されていない場合は、「コード」ウィンドウの上部を
      <strong>ダブルクリック</strong>
      するとウィンドウが最大化されます。以下、最大化した状態で作業をしてください。</p>
      <figure>
      <img src="figs/excel-addin-05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="4.0.4" id="手順4"><span class="header-section-number">4.0.4</span> 手順4</h3>
      <p>このコードウィンドウのなかの <code>Option Explicit</code>
      につづけて、<strong>生成AIで作成したVBAプログラム</strong> を追記していきます。</p>
      <p>まずは、練習のために以下の「VBAプログラム」を貼付けてみてください。</p>
      <div class="sourceCode" id="cb1" data-caption="A1に乱数を書き込む処理"><pre
      class="sourceCode numberSource vb numberLines"><code class="sourceCode monobasic"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">Public</span> <span class="kw">Sub </span>A1に乱数を書き込む処理()</span>
<span id="cb1-2"><a href="#cb1-2"></a>    </span>
<span id="cb1-3"><a href="#cb1-3"></a>    <span class="co">&#39; アクティブシートのA1セルに乱数（0～10）を書き込み</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>    ActiveSheet.Range(<span class="st">&quot;A1&quot;</span>).Value = Int(Rnd * 11)</span>
<span id="cb1-5"><a href="#cb1-5"></a>    </span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">End Sub</span></span></code></pre></div>
      <p>以下のように、<code>Option Explicit</code> を <strong>上書きしないように</strong>
      を貼付けてください。</p>
      <figure>
      <img src="figs/excel-addin-06.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="4.0.5" id="手順5"><span class="header-section-number">4.0.5</span> 手順5</h3>
      <p>これを <strong>アドインファイル</strong>
      として保存していきます。アドインは、原則として以下のパス (位置)
      に保存します。<code>xxxx</code>
      の部分は、皆さんのユーザ名に置き換えてください。セミナー会場のPCを利用している場合は
      <code>gs01</code> や <code>gs05</code> がユーザ名になります。</p>
      <pre><code>C:\Users\xxxx\AppData\Roaming\Microsoft\AddIns</code></pre>
      <p>上記に配置することで、エクセルを起動したときに自動で読み込まれることになります。</p>
      <p>まずは、VBAエディタの「<strong>保存ボタン</strong>」を押下してください。</p>
      <figure>
      <img src="figs/excel-addin-20.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のように「名前を付けて保存」のダイアログが表示されるので、まずは「ファイルの種類」を「<strong>Excel
      アドイン(<code>*.xlam</code>)</strong>」に変更してください
      (ドロップダウンリストの下部のほうにあります)。</p>
      <p>ファイルの種類を変更すると「保存先」が自動で
      <code>C:\Users\xxxx\AppData\Roaming\Microsoft\AddIns</code> になるので、確認してください。</p>
      <figure>
      <img src="figs/excel-addin-07.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>ファイル名を <span class="masked">マイアドイン.xlam</span>
      に書き換えてからて、ダイアログの右下の「保存」を押下してください。</p>
      <p>以上でアドインとしての設定は完了です。つづいて、正しく設定できているかを確認していきます。</p>
      <h3 data-number="4.0.6" id="手順6"><span class="header-section-number">4.0.6</span> 手順6</h3>
      <p>一旦、エクセルを完全終了してください。</p>
      <p>つづいて、エクセルを起動して「<strong>新規</strong>」から「<strong>空白のブック</strong>」を選択してください。さらに「<strong>ファイル</strong>」から「<strong>オプション</strong>」を選択してください。</p>
      <figure>
      <img src="figs/excel-09.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「Excelのオプション」というダイアログが表示されるので、左パネルから「<strong>アドイン</strong>」を選択
      (❶)
      して、「<strong>アクティブではないアプリケーション</strong>」のなかに先ほど保存した「<strong>マイアドイン</strong>」が含まれていることを確認
      (❷) してください。</p>
      <figure>
      <img src="figs/excel-addin-08.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>この「マイアドイン」をアクティブに変更 (有効化) するために、「設定」のボタンを押下 (❸)
      してください。</p>
      <h3 data-number="4.0.7" id="手順7"><span class="header-section-number">4.0.7</span> 手順7</h3>
      <p>「<strong>マイアドイン</strong>」にチェックを入れて「<strong>OK</strong>」を押下してください。</p>
      <figure>
      <img src="figs/excel-addin-09.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="4.0.8" id="手順8"><span class="header-section-number">4.0.8</span> 手順8</h3>
      <p>マイアドインのなかの「<strong>A1に乱数を書き込む処理</strong>」というマクロを、以下のようにエクセルのリボンから「ワンクリック」で呼び出せるように設定していきます。</p>
      <figure>
      <img src="figs/excel-addin-21.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「ホーム」タブの右隣に「マクロ」タブを作成して、そこに配置していきます。「Excelのオプション」ダイアログから、「<strong>リボンのユーザ設定</strong>」を選択(➊)してください。</p>
      <p>つづいて、次のように「<strong>ホーム</strong>」を選択(❷)します
      (ホームのチェックボックスを反転させないように注意してください)。そして「<strong>新しいタブ</strong>」のボタンを押下(❸)してください。</p>
      <figure>
      <img src="figs/excel-addin-10.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のように「ホーム」の下に「<strong>新しいタブ(ユーザー設定)</strong>」が追加される(➊)ので、「名前を変更」のボタン押下して…</p>
      <ul>
      <li>「<strong>新しいタブ(ユーザー設定)</strong>」を「<strong>マクロ(ユーザー設定)</strong>」に名前変更してください。</li>
      <li>「<strong>新しいグループ(ユーザー設定)</strong>」を「<strong>練習(ユーザー設定)</strong>」に名前変更してください。</li>
      </ul>
      <p>いずれも、自動で <code>(ユーザー設定)</code> という文字列が付加されます。</p>
      <figure>
      <img src="figs/excel-addin-11.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のような状態になっていればOKです。</p>
      <figure>
      <img src="figs/excel-addin-12.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="4.0.9" id="手順9"><span class="header-section-number">4.0.9</span> 手順9</h3>
      <p>先の手順で追加したリボンのなかに、マクロの呼び出しボタンを設定していきます。</p>
      <p>まずは「<strong>練習(ユーザー設定)</strong>」を選択(➊)して、コマンド選択のドロップダウンリストを「<strong>マクロ</strong>」に切り替えます(❷)。</p>
      <p>このようにすると、先ほど有効化したアンドイン (マイアドイン.xlam)
      に含まれるマクロが表示されるので、「<strong>A1に乱数を書き込む処理</strong>」を選んで(❸)、「<strong>追加(A)&gt;&gt;</strong>」ボタンを押下(❹)します。</p>
      <figure>
      <img src="figs/excel-addin-13.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のような状態になっていればOKです。なお、必要に応じて「A1に乱数を書き込む処理」の名前を変更することもできます
      (タブやグループンの名前変更と同じです)。</p>
      <figure>
      <img src="figs/excel-addin-14.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>ダイアログ右下の「OK」ボタンを押下して、「Excelのオプション」ダイアログを終了してください。</p>
      <h3 data-number="4.0.10" id="手順10"><span class="header-section-number">4.0.10</span>
      手順10</h3>
      <p>以上で、設定は完了です。マクロのタブから「<strong>A1に乱数を書き込む処理</strong>」をクリックしてみてください。</p>
      <figure>
      <img src="figs/excel-addin-15.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <ul>
      <li>エクセルを閉じて、再度開いたときも、同様にマクロが呼び出せることを確認してください。</li>
      <li>任意のエクセルファイルを開いているとき、そのファイル (ブック・シート)
      を対象にマクロが機能することを確認してください。</li>
      </ul>
      <h1 data-number="5" id="生成aiにマクロを作成させる"><span
      class="header-section-number">5</span> 生成AIにマクロを作成させる</h1>
      <p>ここからは、<strong>生成AIを用いてマクロを記述し</strong>、それを作成済みの<strong>「アドイン」に追加登録する手順</strong>について詳しく解説していきます。</p>
      <h2 data-number="5.1" id="マクロ-vbaプログラム-の作成依頼プロンプト例-①"><span
      class="header-section-number">5.1</span> マクロ (VBAプログラム) の作成依頼プロンプト例 ①</h2>
      <p>たとえば「<strong>すべてのシートのカーソル位置をA1に移動する処理</strong>」のマクロを実装したいとき、生成AIには次のようなプロンプトを与えます。</p>
      <p>(プロンプト例)</p>
      <blockquote>
      <p>エクセルにおいて、すべてのシートのカーソル位置をA1にするような VBAプログラム (マクロ)
      を書いてください。</p>
      </blockquote>
      <p>ここで「<strong>エクセル</strong>」や「<strong>VBAプログラム
      (あるいはマクロ)</strong>」といったキーワードは、プロンプトのなかに必ず含めるようにしてください。また「シート」や「A1
      (セル参照)」のような <span class="masked">エクセル固有の用語を正しく使って指示すること</span>
      も重要なポイントとなります。</p>
      <p>実際に試してみると、VBA プログラム (コード)
      を生成してくれるはずです。ただし、<strong>上記のような簡素なプロンプトでは、</strong> <span
      class="masked">生成されるコードの内容にばらつき</span>
      がでやすかったり、<strong>アドインとして組み込むには不適切なコード</strong>
      (＝実行時エラーが発生したり、意図した動作をしなかったりするコード) が生成される可能性が
      (相対的に) 高くなります。</p>
      <figure>
      <img src="figs/gai-03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>これは、生成AIが <span class="masked">何を前提としてコードを書くべきか</span>
      を明確に理解できていないまま
      (＝与えられないまま)、<strong>推測に基づいてコードを生成してしまうこと</strong>によるものです。一般的に「マクロ」と言うと、エクセルブック
      (<code>.xlsm</code> など)
      に記述するケースが多いため、生成AIもそれを前提にコードを生成することが考えられます。</p>
      <p>しかし、そのようなコードは、アドインファイルに組み込んだとき、状況によっては正しく動作しないことがあります。</p>
      <h2 data-number="5.2" id="マクロ-vbaプログラム-の作成依頼プロンプト例-②"><span
      class="header-section-number">5.2</span> マクロ (VBAプログラム) の作成依頼プロンプト例 ②</h2>
      <p>以上のようなケースにおいても、ある程度の知識やスキルがあればコードを修正して使うことはできます。しかし、ここでは
      <span class="masked">プログラミングの経験がない利用者</span>
      を前提にしています。そのため、生成AIには
      <strong>あらかじめ十分な実行条件を含んだプロンプト</strong> を与えることが重要となります。</p>
      <p>具体的には、次のようなプロンプトが推奨されます。</p>
      <pre><code># 指示  
現在ユーザーが操作中の Excel のアクティブシート（またはその親ブック）を対象に、「#やりたいこと」で指定された処理を行う **VBA のサブルーチン** を生成してください。
  
# やりたいこと  
（ここに自然言語で、できるだけ具体的に処理内容を記述してください）
  
# 実装前提  
以下の条件をすべて満たすようにコードを作成してください。
  
- コードはアドインファイル（拡張子 `.xlam`）の **標準モジュール** に記述することを前提とします。  
- `Option Explicit` は有効であるものとし、**生成するコードには含めないでください**。  
- 対象ブックは、`ActiveSheet.Parent` を用いて取得してください（`ThisWorkbook` は使用しないでください）。  
- 操作対象のワークシートは、原則として `ActiveSheet` またはその親ブック内の全ワークシートとしてください。
  
# コーディングガイドライン  
  
- **処理前の状態（アクティブシート）を保存し、処理後に復元するコードを必ず含めてください。**
- `Application.ScreenUpdating = False` など、画面更新の一時停止を可能な範囲で使用し、**処理のパフォーマンスと視覚的ノイズの抑制**に配慮してください。
- `On Error GoTo` 構文を使い、エラー時には以下の処理を実行してください：
  - 一時的に変更した `Application` の設定を元に戻す。
  - エラー内容（`Err.Number` と `Err.Description`）を `MsgBox` でユーザーに通知する。
  - 必要に応じて `Debug.Print` にエラーメッセージと発生箇所（プロシージャ名）を出力する。
- エラーが発生しなかった場合は、**`MsgBox` による完了通知は不要です**（静かに終了する仕様）。
- 初心者にも理解できるように、**各処理ブロックに日本語で簡潔かつ具体的なコメントを記述**してください。
- サブルーチンは `Public` に設定し、日本語で機能が明確に伝わる命名（例：`全シートのカーソルをA1に戻す`）をしてください。
- グローバル変数の使用は避け、**サブルーチン内で処理が完結するように**してください。
  
# 補足（生成AIによるサポートのために重要）
- 生成されたコード内で使われているすべての関数・定数・プロパティは、**標準のExcel VBA環境で利用可能なものに限定してください**（外部ライブラリや参照設定の追加は不可）。
- **初回エラーが起きやすい箇所**（オブジェクトの存在チェックや選択状態の変更など）には、予防的な `If` や `Is Nothing` チェックを挿入してください。
- `With` や `For Each` のブロックでは、**途中で対象オブジェクトが変化しないことを前提に書いてください**。
- このプロンプトは VBA に不慣れなユーザーが使用することを想定しています。そのため、**後から問題発生時に再質問しやすいよう**に、処理構成や例外処理を明確にしておいてください。</code></pre>
      <p>プロンプトが急に複雑になったように感じるかもしれませんが、基本的にみなさんが記述するのは
      <span class="masked">#やりたいこと</span> の部分だけです。その他の部分は <strong>テンプレート
      (雛形) として、そのまま使ってください</strong>。</p>
      <p>実際に、上記のプロンプトの「<strong>#
      やりたいこと</strong>」だけを以下の内容に差し替えて、生成AIに貼付けて、送信してみてください。生成AIから回答が生成されるはずです。</p>
      <blockquote>
      <p>すべてのシートのカーソル位置をA1に揃えたい</p>
      </blockquote>
      <p>実行結果の一例を次に示します。以下のように「<i class="fa-solid fa-copy"></i>
      <strong>コピーする</strong>」をクリックすることで、VBAプログラムをクリップボードに取得することができます。</p>
      <figure>
      <img src="figs/gai-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="5.3" id="アドインにマクロを追加する"><span
      class="header-section-number">5.3</span> アドインにマクロを追加する</h2>
      <p>エクセルを起動して、空白のブックを新規作成してください
      (既存のファイルのオープンでも問題ありません)。</p>
      <p>「<strong>開発</strong>」タブから「<strong>Visual
      Basic</strong>」のアイコンをクリックして「VBAエディタ」を起動してください。あるいは
      [Alt]+[F11] のショートカットで「<strong>VBAエディタ</strong>」を起動してください。</p>
      <p>次のように「<strong>マイアドイン.xlam</strong>」の「<strong>Module1</strong>」が選択されていることを確認して、先ほど記述した
      <code>Public Sub A1に乱数を書き込む処理()</code> ～ <code>End Sub</code>
      以降の行に、生成AIが出力したコードを貼り付けてください。</p>
      <figure>
      <img src="figs/excel-addin-16.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <div class="note type-caution">
      <p><strong>「Option Explicit」の重複に注意</strong></p>
      <p>生成AIに与えたプロンプトには <code>Option Explicit</code>
      を含めないように指示していますが、ときどき <code>Option Explicit</code>
      を出力してくることがあります。</p>
      <p>そのとき、以下のように <code>Option Explicit</code> を
      <strong>重複記述すると不具合の原因となるので注意</strong> してください。</p>
      <figure>
      <img src="figs/excel-addin-22.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      </div>
      <h2 data-number="5.4" id="追加したマクロの動作チェック"><span
      class="header-section-number">5.4</span> 追加したマクロの動作チェック</h2>
      <p>追加したマクロが正常に動作するかチェックします。以下のように追加した処理 (ここでは
      <code>全シートのカーソルをA1に戻す</code>) を選択して「実行ボタン
      <i class="fa-solid fa-play"></i>」を押下してください。</p>
      <figure>
      <img src="figs/excel-addin-17.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>実際にエクセルブック (<code>Book1.xlsx</code>)
      のほうで「<strong>このマクロが意図した動作をしているか</strong>」を確認してください。問題なく動作するこを確認できたら「<strong>VBAエディタ</strong>」の「保存<i class="fa-solid fa-floppy-disk"></i>」のボタンを押下してください。アドインファイルの更新内容が保存されます。</p>
      <figure>
      <img src="figs/excel-addin-23.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h3 data-number="5.4.1" id="マクロの実行時エラーが発生したときは"><span
      class="header-section-number">5.4.1</span> マクロの「実行時エラー」が発生したときは</h3>
      <p>VBAプログラムに問題があった場合、実行時に次のようなダイアログが表示されます。その場合は「<strong>OK</strong>」を押下してください。</p>
      <figure>
      <img src="figs/error-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>上記ダイアログの「<strong>OK</strong>」を押下すると「<strong>中断</strong>」という状態になります。通常の編集モードに戻るためには、下図のように「停止マーク」のボタンを押下してください</p>
      <figure>
      <img src="figs/error-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>また「継続」「終了」「デバッグ」「ヘルプ」のボタンを持ったダイアログが表示されたときは「<strong>終了</strong>」を選択してください。また、無限ループが生じた際は
      <code>Escキー</code> の押下で抜けることができます。</p>
      <h3 data-number="5.4.2" id="実行に失敗したり意図した動作をしないときは"><span
      class="header-section-number">5.4.2</span> 実行に失敗したり、意図した動作をしないときは……</h3>
      <p>実行に失敗したり、意図した動作をしない場合は、もう一度、同じプロンプトを生成AIに与え、<strong>再生成されたコードに差し替えて実行してみること</strong>
      をお勧めします。</p>
      <p>それでもエラーがつづく場合は、イミディエイトウィンドウに表示されるエラーメッセージの内容を、プロンプトに与えて修正依頼をすることで、問題が解決することもあります。</p>
      <figure>
      <img src="figs/excel-addin-24.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="5.5" id="追加したマクロをリボンに登録"><span
      class="header-section-number">5.5</span> 追加したマクロをリボンに登録</h2>
      <p>エクセル (≠VBAエディタ)
      の「<strong>ファイル</strong>」から「<strong>オプション</strong>」を選択し、「<strong>リボンのユーザー設定</strong>」から以下の手順で追加したマクロをリボンに登録してください。</p>
      <figure>
      <img src="figs/excel-addin-18.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のようにリボンに登録され、任意のタイミングでマクロを呼び出すことができるようになります。</p>
      <figure>
      <img src="figs/excel-addin-19.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>また、次のような手順で、リボンに表示する際のマクロの「<strong>アイコン</strong>」と「<strong>名前</strong>」を変更することもできます。</p>
      <figure>
      <img src="figs/excel-addin-25.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>次のようにアイコンと表示名を変更することができます。</p>
      <figure>
      <img src="figs/excel-addin-26.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h2 data-number="5.6" id="さらにマクロを追加"><span class="header-section-number">5.6</span>
      さらにマクロを追加</h2>
      <p>「Module1」が肥大化した場合は、次の手順でモジュールを追加し、そこにVBAプログラムを貼付けてください。</p>
      <figure>
      <img src="figs/excel-addin-27.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以下では、新たに追加した「Module2」にVBAプログラムを記述します。</p>
      <figure>
      <img src="figs/excel-addin-28.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <h1 data-number="6" id="演習"><span class="header-section-number">6</span> 演習</h1>
      <p>以上で全般的な解説は終了です。演習として、次のようなマクロを生成AIに作成させ、アドインに登録してみてください。</p>
      <ul>
      <li>すべてのシートについて、表示倍率を100%にする。</li>
      <li>選択しているセルに対して、任意の表示形式 (例：小数点桁数を1に固定) と条件付き書式
      (例：負の数は赤色表示) を同時設定する</li>
      </ul>
      <h1 data-number="7" id="補足-マクロ有効ブックのオープン"><span
      class="header-section-number">7</span> 補足: マクロ有効ブックのオープン</h1>
      <p>自分以外が作成した<strong>マクロ有効ブック</strong>（＝マクロを含む Excel
      ドキュメント）を開こうとすると、次のような<strong>赤色の警告</strong>
      が表示され、マクロが自動でブロック（無効化）されることがあります。</p>
      <figure>
      <img src="figs/macro-01.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>このドキュメントについて、マクロを有効化したい場合は、そのファイルを一旦閉じてから、エクスプローラで対象ファイルを右クリックして「<strong>プロパティ</strong>」を選択し、タブ「<strong>全般</strong>」の下部にある「<strong>セキュリティ</strong>」の項目の「<strong>許可する</strong>」にチェックをいれてください。</p>
      <figure>
      <img src="figs/macro-02.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>また、ファイルの作成者に関わらずマクロを含むExcelドキュメントを開くと、以下のようにマクロが自動で無効化されることがあります（<strong>黄色の警告</strong>）。そのファイルでマクロを有効化するためには「<strong>コンテンツの有効化</strong>」のボタンをクリックしてください。</p>
      <figure>
      <img src="figs/macro-03.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>以上のようなマクロに関連する「<strong>警告表示</strong>」や「<strong>自動ブロック</strong>」は、設定のなかの「<strong>トラストセンター}</strong>」という項目から変更することができます。どうしてもマクロ付きExcelドキュメントが有効化できない場合などは、次の手順で「トラストセンターの設定」を確認・変更してください。</p>
      <ol type="1">
      <li>Excelの「<strong>ファイル</strong>」から「<strong>オプション</strong>」を選択して「<strong>Excelのオプション</strong>」のダイアログを表示してください。</li>
      <li>ダイアログの左側のメニューから「<strong>トラストセンター</strong>」を選択して、「<strong>トラストセンターの設定</strong>」をクリックしてください。</li>
      </ol>
      <figure>
      <img src="figs/macro-04.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <ol start="3" type="1">
      <li>トラストセンターのダイアログの左側のメニューから「<strong>マクロの設定</strong>」を選択して、項目の設定を変更してください。</li>
      </ol>
      <figure>
      <img src="figs/macro-05.png" alt="img" />
      <figcaption aria-hidden="true">img</figcaption>
      </figure>
      <p>「<strong>マクロの設定</strong>」の項目は、以下のように「<strong>警告して、VBAマクロを無効にする</strong>」を選んでおくことをお勧めします。
      以上の設定を変更してもマクロが有効化されない場合は、ウィルス対策ソフトウェアの設定などを確認してください（詳細については各自でウェブ検索してください）。</p>
      <h1 data-number="8" id="補足-マクロを利用するときの注意点"><span
      class="header-section-number">8</span> 補足: マクロを利用するときの注意点</h1>
      <p>VBAによるマクロは、それが組み込まれたExcelファイルの内部データ（シートやセル）を操作するだけではなく、Officeアプリとは無関係のファイルを対象とする操作や、インターネット通信、別のプログラムの起動も可能となっています。</p>
      <p>つまり、マクロは <span class="masked">ユーザのドキュメントフォルダを全消去</span>
      したり、インターネットから <span class="masked">マルウェアをダウンロードして実行</span>
      したりすることも可能となっています。そのため、信頼できないファイルに付属するマクロの取扱い（実行許可の可否判断）には十分に注意してください。</p>
      <!-- ---------------------------------------- -->
    </main>

    <footer class="markdown-body">
      <p><a href="https://takeshiwada1980.github.io/Excel-Macro/">講義資料のIndexに移動</a></p>
    </footer>

    <script>
      window.onload = function () {
        // ナビゲーション関連
        let openBtn = document.getElementsByClassName("openbtn")[0];
        let navPnl = document.getElementById("g-nav");
        openBtn.onclick = () => {
          openBtn.classList.toggle("active");
          navPnl.classList.toggle("panelactive");
        };

        let items = navPnl.getElementsByTagName("a");
        Array.from(items).forEach((item) => {
          item.onclick = () => {
            openBtn.classList.toggle("active");
            navPnl.classList.toggle("panelactive");
          };
        });

        // マスク処理
        let maskedSpans = document.getElementsByClassName("masked");
        Array.from(maskedSpans).forEach((span) => {
          span.onclick = () => {
            span.classList.toggle("open");
          };
        });

        // data-startfrom 属性の行番号カウンタのリセット
        document.querySelectorAll("div.sourceCode").forEach(function (div) {
          var startFrom = div.getAttribute("data-startfrom");
          if (startFrom != null) {
            div.style.counterReset = "pg-line " + (startFrom - 1);
          }
        });

        // 画像にリンクを付与
        // let images = document.querySelectorAll("figure img");
        // Array.from(images).forEach((img) => {
        //   img.onclick = () => {
        //     location.href = img.getAttribute("src");
        //   };
        // });
      };
    </script>
  </body>
</html>
